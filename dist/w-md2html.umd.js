/*!
 * w-md2html v1.0.15
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs"),require("sharp"),require("marked"),require("marked-katex-extension"),require("marked-footnote"),require("highlight.js"),require("marked-highlight"),require("cheerio")):"function"==typeof define&&define.amd?define(["path","fs","sharp","marked","marked-katex-extension","marked-footnote","highlight.js","marked-highlight","cheerio"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-md2html"]=e(t.path,t.fs,t.sharp,t.marked,t["marked-katex-extension"],t["marked-footnote"],t.highlight.js,t["marked-highlight"],t.cheerio)}(this,function(t,e,r,n,o,i,u,c,a){"use strict";function f(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}),e.default=t,Object.freeze(e)}var l=f(a),s=Array.isArray,p="object"==typeof global&&global&&global.Object===Object&&global,h="object"==typeof self&&self&&self.Object===Object&&self,b=p||h||Function("return this")(),y=b.Symbol,v=Object.prototype,d=v.hasOwnProperty,g=v.toString,j=y?y.toStringTag:void 0;var _=Object.prototype.toString;var m=y?y.toStringTag:void 0;function w(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":m&&m in Object(t)?function(t){var e=d.call(t,j),r=t[j];try{t[j]=void 0;var n=!0}catch(t){}var o=g.call(t);return n&&(e?t[j]=r:delete t[j]),o}(t):function(t){return _.call(t)}(t)}function O(t){return null!=t&&"object"==typeof t}function S(t){return"symbol"==typeof t||O(t)&&"[object Symbol]"==w(t)}var A=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,x=/^\w*$/;function z(t,e){if(s(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!S(t))||(x.test(t)||!A.test(t)||null!=e&&t in Object(e))}function $(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function k(t){if(!$(t))return!1;var e=w(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var E,P=b["__core-js_shared__"],F=(E=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+E:"";var R=Function.prototype.toString;function H(t){if(null!=t){try{return R.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var T=/^\[object .+?Constructor\]$/,I=Function.prototype,M=Object.prototype,B=I.toString,N=M.hasOwnProperty,U=RegExp("^"+B.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function D(t){return!(!$(t)||(e=t,F&&F in e))&&(k(t)?U:T).test(H(t));var e}function q(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return D(r)?r:void 0}var C=q(Object,"create");var L=Object.prototype.hasOwnProperty;var W=Object.prototype.hasOwnProperty;function G(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function V(t,e){return t===e||t!=t&&e!=e}function J(t,e){for(var r=t.length;r--;)if(V(t[r][0],e))return r;return-1}G.prototype.clear=function(){this.__data__=C?C(null):{},this.size=0},G.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},G.prototype.get=function(t){var e=this.__data__;if(C){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return L.call(e,t)?e[t]:void 0},G.prototype.has=function(t){var e=this.__data__;return C?void 0!==e[t]:W.call(e,t)},G.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=C&&void 0===e?"__lodash_hash_undefined__":e,this};var Q=Array.prototype.splice;function K(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}K.prototype.clear=function(){this.__data__=[],this.size=0},K.prototype.delete=function(t){var e=this.__data__,r=J(e,t);return!(r<0)&&(r==e.length-1?e.pop():Q.call(e,r,1),--this.size,!0)},K.prototype.get=function(t){var e=this.__data__,r=J(e,t);return r<0?void 0:e[r][1]},K.prototype.has=function(t){return J(this.__data__,t)>-1},K.prototype.set=function(t,e){var r=this.__data__,n=J(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var X=q(b,"Map");function Y(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Z(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.size=0,this.__data__={hash:new G,map:new(X||K),string:new G}},Z.prototype.delete=function(t){var e=Y(this,t).delete(t);return this.size-=e?1:0,e},Z.prototype.get=function(t){return Y(this,t).get(t)},Z.prototype.has=function(t){return Y(this,t).has(t)},Z.prototype.set=function(t,e){var r=Y(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function tt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(tt.Cache||Z),r}tt.Cache=Z;var et,rt,nt,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/\\(\\)?/g,ut=(et=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ot,function(t,r,n,o){e.push(n?o.replace(it,"$1"):r||t)}),e},rt=tt(et,function(t){return 500===nt.size&&nt.clear(),t}),nt=rt.cache,rt),ct=ut;function at(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var ft=y?y.prototype:void 0,lt=ft?ft.toString:void 0;function st(t){if("string"==typeof t)return t;if(s(t))return at(t,st)+"";if(S(t))return lt?lt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function pt(t){return null==t?"":st(t)}function ht(t,e){return s(t)?t:z(t,e)?[t]:ct(pt(t))}function bt(t){if("string"==typeof t||S(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function yt(t,e){for(var r=0,n=(e=ht(e,t)).length;null!=t&&r<n;)t=t[bt(e[r++])];return r&&r==n?t:void 0}function vt(t,e,r){var n=null==t?void 0:yt(t,e);return void 0===n?r:n}function dt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var gt,jt=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),u=i.length;u--;){var c=i[gt?u:++n];if(!1===e(o[c],c,o))break}return t};function _t(t){return O(t)&&"[object Arguments]"==w(t)}var mt=Object.prototype,wt=mt.hasOwnProperty,Ot=mt.propertyIsEnumerable,St=_t(function(){return arguments}())?_t:function(t){return O(t)&&wt.call(t,"callee")&&!Ot.call(t,"callee")},At=St;var xt="object"==typeof exports&&exports&&!exports.nodeType&&exports,zt=xt&&"object"==typeof module&&module&&!module.nodeType&&module,$t=zt&&zt.exports===xt?b.Buffer:void 0,kt=($t?$t.isBuffer:void 0)||function(){return!1},Et=/^(?:0|[1-9]\d*)$/;function Pt(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Et.test(t))&&t>-1&&t%1==0&&t<e}function Ft(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var Rt={};function Ht(t){return function(e){return t(e)}}Rt["[object Float32Array]"]=Rt["[object Float64Array]"]=Rt["[object Int8Array]"]=Rt["[object Int16Array]"]=Rt["[object Int32Array]"]=Rt["[object Uint8Array]"]=Rt["[object Uint8ClampedArray]"]=Rt["[object Uint16Array]"]=Rt["[object Uint32Array]"]=!0,Rt["[object Arguments]"]=Rt["[object Array]"]=Rt["[object ArrayBuffer]"]=Rt["[object Boolean]"]=Rt["[object DataView]"]=Rt["[object Date]"]=Rt["[object Error]"]=Rt["[object Function]"]=Rt["[object Map]"]=Rt["[object Number]"]=Rt["[object Object]"]=Rt["[object RegExp]"]=Rt["[object Set]"]=Rt["[object String]"]=Rt["[object WeakMap]"]=!1;var Tt="object"==typeof exports&&exports&&!exports.nodeType&&exports,It=Tt&&"object"==typeof module&&module&&!module.nodeType&&module,Mt=It&&It.exports===Tt&&p.process,Bt=function(){try{var t=It&&It.require&&It.require("util").types;return t||Mt&&Mt.binding&&Mt.binding("util")}catch(t){}}(),Nt=Bt&&Bt.isTypedArray,Ut=Nt?Ht(Nt):function(t){return O(t)&&Ft(t.length)&&!!Rt[w(t)]},Dt=Object.prototype.hasOwnProperty;function qt(t,e){var r=s(t),n=!r&&At(t),o=!r&&!n&&kt(t),i=!r&&!n&&!o&&Ut(t),u=r||n||o||i,c=u?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],a=c.length;for(var f in t)!e&&!Dt.call(t,f)||u&&("length"==f||o&&("offset"==f||"parent"==f)||i&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Pt(f,a))||c.push(f);return c}var Ct=Object.prototype;var Lt=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Wt=Lt,Gt=Object.prototype.hasOwnProperty;function Vt(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Ct))return Wt(t);var e,r,n=[];for(var o in Object(t))Gt.call(t,o)&&"constructor"!=o&&n.push(o);return n}function Jt(t){return null!=t&&Ft(t.length)&&!k(t)}function Qt(t){return Jt(t)?qt(t):Vt(t)}var Kt=function(t,e){return function(r,n){if(null==r)return r;if(!Jt(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}(function(t,e){return t&&jt(t,e,Qt)}),Xt=Kt;function Yt(t){return t}function Zt(t,e){var r;return(s(t)?dt:Xt)(t,"function"==typeof(r=e)?r:Yt)}function te(t){var e=this.__data__=new K(t);this.size=e.size}te.prototype.clear=function(){this.__data__=new K,this.size=0},te.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},te.prototype.get=function(t){return this.__data__.get(t)},te.prototype.has=function(t){return this.__data__.has(t)},te.prototype.set=function(t,e){var r=this.__data__;if(r instanceof K){var n=r.__data__;if(!X||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Z(n)}return r.set(t,e),this.size=r.size,this};function ee(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Z;++e<r;)this.add(t[e])}function re(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function ne(t,e){return t.has(e)}ee.prototype.add=ee.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},ee.prototype.has=function(t){return this.__data__.has(t)};function oe(t,e,r,n,o,i){var u=1&r,c=t.length,a=e.length;if(c!=a&&!(u&&a>c))return!1;var f=i.get(t),l=i.get(e);if(f&&l)return f==e&&l==t;var s=-1,p=!0,h=2&r?new ee:void 0;for(i.set(t,e),i.set(e,t);++s<c;){var b=t[s],y=e[s];if(n)var v=u?n(y,b,s,e,t,i):n(b,y,s,t,e,i);if(void 0!==v){if(v)continue;p=!1;break}if(h){if(!re(e,function(t,e){if(!ne(h,e)&&(b===t||o(b,t,r,n,i)))return h.push(e)})){p=!1;break}}else if(b!==y&&!o(b,y,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p}var ie=b.Uint8Array;function ue(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function ce(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var ae=y?y.prototype:void 0,fe=ae?ae.valueOf:void 0;var le=Object.prototype.propertyIsEnumerable,se=Object.getOwnPropertySymbols,pe=se?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(se(t),function(e){return le.call(t,e)}))}:function(){return[]},he=pe;function be(t){return function(t,e,r){var n=e(t);return s(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,Qt,he)}var ye=Object.prototype.hasOwnProperty;var ve=q(b,"DataView"),de=q(b,"Promise"),ge=q(b,"Set"),je=q(b,"WeakMap"),_e="[object Map]",me="[object Promise]",we="[object Set]",Oe="[object WeakMap]",Se="[object DataView]",Ae=H(ve),xe=H(X),ze=H(de),$e=H(ge),ke=H(je),Ee=w;(ve&&Ee(new ve(new ArrayBuffer(1)))!=Se||X&&Ee(new X)!=_e||de&&Ee(de.resolve())!=me||ge&&Ee(new ge)!=we||je&&Ee(new je)!=Oe)&&(Ee=function(t){var e=w(t),r="[object Object]"==e?t.constructor:void 0,n=r?H(r):"";if(n)switch(n){case Ae:return Se;case xe:return _e;case ze:return me;case $e:return we;case ke:return Oe}return e});var Pe=Ee,Fe="[object Arguments]",Re="[object Array]",He="[object Object]",Te=Object.prototype.hasOwnProperty;function Ie(t,e,r,n,o,i){var u=s(t),c=s(e),a=u?Re:Pe(t),f=c?Re:Pe(e),l=(a=a==Fe?He:a)==He,p=(f=f==Fe?He:f)==He,h=a==f;if(h&&kt(t)){if(!kt(e))return!1;u=!0,l=!1}if(h&&!l)return i||(i=new te),u||Ut(t)?oe(t,e,r,n,o,i):function(t,e,r,n,o,i,u){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new ie(t),new ie(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return V(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var c=ue;case"[object Set]":var a=1&n;if(c||(c=ce),t.size!=e.size&&!a)return!1;var f=u.get(t);if(f)return f==e;n|=2,u.set(t,e);var l=oe(c(t),c(e),n,o,i,u);return u.delete(t),l;case"[object Symbol]":if(fe)return fe.call(t)==fe.call(e)}return!1}(t,e,a,r,n,o,i);if(!(1&r)){var b=l&&Te.call(t,"__wrapped__"),y=p&&Te.call(e,"__wrapped__");if(b||y){var v=b?t.value():t,d=y?e.value():e;return i||(i=new te),o(v,d,r,n,i)}}return!!h&&(i||(i=new te),function(t,e,r,n,o,i){var u=1&r,c=be(t),a=c.length;if(a!=be(e).length&&!u)return!1;for(var f=a;f--;){var l=c[f];if(!(u?l in e:ye.call(e,l)))return!1}var s=i.get(t),p=i.get(e);if(s&&p)return s==e&&p==t;var h=!0;i.set(t,e),i.set(e,t);for(var b=u;++f<a;){var y=t[l=c[f]],v=e[l];if(n)var d=u?n(v,y,l,e,t,i):n(y,v,l,t,e,i);if(!(void 0===d?y===v||o(y,v,r,n,i):d)){h=!1;break}b||(b="constructor"==l)}if(h&&!b){var g=t.constructor,j=e.constructor;g==j||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof j&&j instanceof j||(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,o,i))}function Me(t,e,r,n,o){return t===e||(null==t||null==e||!O(t)&&!O(e)?t!=t&&e!=e:Ie(t,e,r,n,Me,o))}function Be(t){return t==t&&!$(t)}function Ne(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function Ue(t){var e=function(t){for(var e=Qt(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Be(o)]}return e}(t);return 1==e.length&&e[0][2]?Ne(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var c=r[o];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<i;){var a=(c=r[o])[0],f=t[a],l=c[1];if(u&&c[2]){if(void 0===f&&!(a in t))return!1}else{var s=new te;if(n)var p=n(f,l,a,t,e,s);if(!(void 0===p?Me(l,f,3,n,s):p))return!1}}return!0}(r,t,e)}}function De(t,e){return null!=t&&e in Object(t)}function qe(t,e){return null!=t&&function(t,e,r){for(var n=-1,o=(e=ht(e,t)).length,i=!1;++n<o;){var u=bt(e[n]);if(!(i=null!=t&&r(t,u)))break;t=t[u]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&Ft(o)&&Pt(u,o)&&(s(t)||At(t))}(t,e,De)}function Ce(t){return function(e){return null==e?void 0:e[t]}}function Le(t){return z(t)?Ce(bt(t)):function(t){return function(e){return yt(e,t)}}(t)}function We(t){return"function"==typeof t?t:null==t?Yt:"object"==typeof t?s(t)?function(t,e){return z(t)&&Be(e)?Ne(bt(t),e):function(r){var n=vt(r,t);return void 0===n&&n===e?qe(r,t):Me(e,n,3)}}(t[0],t[1]):Ue(t):Le(t)}function Ge(t,e){var r=-1,n=Jt(t)?Array(t.length):[];return Xt(t,function(t,o,i){n[++r]=e(t,o,i)}),n}function Ve(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+e];return i}function Je(t,e,r){var n=t.length;return r=void 0===r?n:r,!e&&r>=n?t:Ve(t,e,r)}var Qe=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function Ke(t){return Qe.test(t)}var Xe=Bt&&Bt.isRegExp,Ye=Xe?Ht(Xe):function(t){return O(t)&&"[object RegExp]"==w(t)};var Ze="\\ud800-\\udfff",tr="["+Ze+"]",er="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",rr="\\ud83c[\\udffb-\\udfff]",nr="[^"+Ze+"]",or="(?:\\ud83c[\\udde6-\\uddff]){2}",ir="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="(?:"+er+"|"+rr+")"+"?",cr="[\\ufe0e\\ufe0f]?",ar=cr+ur+("(?:\\u200d(?:"+[nr,or,ir].join("|")+")"+cr+ur+")*"),fr="(?:"+[nr+er+"?",er,or,ir,tr].join("|")+")",lr=RegExp(rr+"(?="+rr+")|"+fr+ar,"g");function sr(t){return Ke(t)?function(t){return t.match(lr)||[]}(t):function(t){return t.split("")}(t)}function pr(t,e,r){return r&&"number"!=typeof r&&function(t,e,r){if(!$(r))return!1;var n=typeof e;return!!("number"==n?Jt(r)&&Pt(e,r.length):"string"==n&&e in r)&&V(r[e],t)}(t,e,r)&&(e=r=void 0),(r=void 0===r?4294967295:r>>>0)?(t=pt(t))&&("string"==typeof e||null!=e&&!Ye(e))&&!(e=st(e))&&Ke(t)?Je(sr(t),0,r):t.split(e,r):[]}var hr=/\s/;var br=/^\s+/;function yr(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&hr.test(t.charAt(e)););return e}(t)+1).replace(br,""):t}function vr(t){return t!=t}function dr(t,e,r){return e==e?function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,r):function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,vr,r)}function gr(t,e,r){if((t=pt(t))&&(r||void 0===e))return yr(t);if(!t||!(e=st(e)))return t;var n=sr(t),o=sr(e),i=function(t,e){for(var r=-1,n=t.length;++r<n&&dr(e,t[r],0)>-1;);return r}(n,o),u=function(t,e){for(var r=t.length;r--&&dr(e,t[r],0)>-1;);return r}(n,o)+1;return Je(n,i,u).join("")}var jr=Array.prototype.join;function _r(t,e){return null==t?"":jr.call(t,e)}var mr=/^[-+]0x[0-9a-f]+$/i,wr=/^0b[01]+$/i,Or=/^0o[0-7]+$/i,Sr=parseInt;function Ar(t){if("number"==typeof t)return t;if(S(t))return NaN;if($(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=$(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=yr(t);var r=wr.test(t);return r||Or.test(t)?Sr(t.slice(2),r?2:8):mr.test(t)?NaN:+t}var xr=1/0;function zr(t){return t?(t=Ar(t))===xr||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function $r(t){var e=zr(t),r=e%1;return e==e?r?e-r:e:0}function kr(t,e,r){var n=null==t?0:t.length;return n?Ve(t,(e=r||void 0===e?1:$r(e))<0?0:e,n):[]}var Er=Ce("length"),Pr="\\ud800-\\udfff",Fr="["+Pr+"]",Rr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Hr="\\ud83c[\\udffb-\\udfff]",Tr="[^"+Pr+"]",Ir="(?:\\ud83c[\\udde6-\\uddff]){2}",Mr="[\\ud800-\\udbff][\\udc00-\\udfff]",Br="(?:"+Rr+"|"+Hr+")"+"?",Nr="[\\ufe0e\\ufe0f]?",Ur=Nr+Br+("(?:\\u200d(?:"+[Tr,Ir,Mr].join("|")+")"+Nr+Br+")*"),Dr="(?:"+[Tr+Rr+"?",Rr,Ir,Mr,Fr].join("|")+")",qr=RegExp(Hr+"(?="+Hr+")|"+Dr+Ur,"g");function Cr(t){return Ke(t)?function(t){for(var e=qr.lastIndex=0;qr.test(t);)++e;return e}(t):Er(t)}function Lr(t){if(null==t)return 0;if(Jt(t))return"string"==typeof(e=t)||!s(e)&&O(e)&&"[object String]"==w(e)?Cr(t):t.length;var e,r=Pe(t);return"[object Map]"==r||"[object Set]"==r?t.size:Vt(t).length}function Wr(t){return!0===(e=t)||!1===e||O(e)&&"[object Boolean]"==w(e);var e}function Gr(t){return"[object String]"===Object.prototype.toString.call(t)}function Vr(t){return!(!Gr(t)||""===t)}function Jr(t){return"[object Array]"===Object.prototype.toString.call(t)}function Qr(t){return"[object Object]"===Object.prototype.toString.call(t)}function Kr(t){return t!=t}function Xr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Qr(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!Gr(t)||""!==t)}(t)||(!!function(t){return!!Jr(t)&&0===t.length}(t)||!!Kr(t)))))}function Yr(t){let e=!1;if(Vr(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Kr(t))return!1;e=!0}return e}function Zr(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function tn(t){if(!Yr(t))return 0;return zr(t)}function en(t,e,r){if(!Vr(t))return"";if(!Vr(e))return"";if(!Gr(r))return"";return String(t).replaceAll(e,r)}function rn(t,e){let r=function(){let t,e,r=new Promise(function(){t=arguments[0],e=arguments[1]});return r.resolve=t,r.reject=e,r}();if(!Jr(t)&&!Qr(t))return r.reject("rs is not an array or object"),r;let n=!1;if(Qr(t)){n=!0;let e=[];Zt(t,(t,r)=>{e.push({k:r,v:t})}),t=e}Zr(e)||(e=function(t){return t});let o=-1,i=[];return t.reduce(function(t,r){return t.then(function(t){i.push(t),o+=1;let u=o,c=r;return n&&(u=r.k,c=r.v),Zr(e)?e(c,u):c})},Promise.resolve()).then(function(t){i.push(t),i=kr(i),r.resolve(i)}).catch(function(t){r.reject(t)}),r}function nn(t){return!!Yr(t)&&(t=tn(t),"number"==typeof(e=t)&&e==$r(e));var e}var on=b.isFinite,un=Math.min;var cn=function(t){var e=Math[t];return function(t,r){if(t=Ar(t),(r=null==r?0:un($r(r),292))&&on(t)){var n=(pt(t)+"e").split("e");return+((n=(pt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),an=cn;function fn(t){if(!Yr(t))return 0;t=tn(t);let e=an(t);return"0"===String(e)?0:e}function ln(t){if(!nn(t))return!1;return fn(t)>=0}function sn(t,e){if(!Vr(t))return"";if(!ln(e))return"";if(0===(e=fn(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}function pn(t,e){return Vr(t)&&ln(e)?0===(e=fn(e))?t:function(t,e){return Vr(t)&&ln(e)?0===(e=fn(e))?"":t.substring(0,e):""}(t,t.length-e):""}function hn(t){if(!Vr(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===sn(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===sn(t,1)){let e=pn(t,1);return":"===sn(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===sn(t,1)){let e=pn(t,1);return 0===e.length?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}function bn(t){if(!Vr(t))return"";let e=hn(t);if(e.isRoot)return e.path;let r=e.path;try{r=r.split("\\").pop().split("/").pop()}catch(t){}return r}function yn(t){if(!Vr(t))return"";let e=bn(t),r=pr(e,".");if(Lr(r)<=1)return e;let n="";try{r=(c=null==(o=r)?0:o.length)?Ve(o,0,(i=c-(i=u||void 0===i?1:$r(i)))<0?0:i):[],n=_r(r,".")}catch(t){}var o,i,u,c;return n}function vn(t){if(!Vr(t))return"";let e=hn(t);if(e.isRoot)return e.path;let r=bn(t=e.path);if(!Vr(r))return t;let n=hn(t=pn(t,r.length));return n.isRoot,n.path}function dn(t){return function(t,e={}){let r=vt(e,"fs");return!!r.existsSync(t)&&!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink()}(t,{fs:e})}var gn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function jn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _n={exports:{}};
/*!
   * w-image-proc v1.0.2
   * (c) 2018-2021 yuda-lyu(semisphere)
   * Released under the MIT License.
   */!function(t,n){t.exports=function(e,r){var o=Array.isArray,i="object"==typeof gn&&gn&&gn.Object===Object&&gn,u="object"==typeof self&&self&&self.Object===Object&&self,c=i||u||Function("return this")(),a=c.Symbol,f=Object.prototype,l=f.hasOwnProperty,s=f.toString,p=a?a.toStringTag:void 0,h=Object.prototype.toString,b=a?a.toStringTag:void 0;function y(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":b&&b in Object(t)?function(t){var e=l.call(t,p),r=t[p];try{t[p]=void 0;var n=!0}catch(t){}var o=s.call(t);return n&&(e?t[p]=r:delete t[p]),o}(t):function(t){return h.call(t)}(t)}function v(t){return null!=t&&"object"==typeof t}function d(t){return"symbol"==typeof t||v(t)&&"[object Symbol]"==y(t)}var g=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,j=/^\w*$/;function _(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function m(t){if(!_(t))return!1;var e=y(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var w,O=c["__core-js_shared__"],S=(w=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"",A=Function.prototype.toString;function x(t){if(null!=t){try{return A.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var z=/^\[object .+?Constructor\]$/,$=Function.prototype,k=Object.prototype,E=$.toString,P=k.hasOwnProperty,F=RegExp("^"+E.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function R(t){return!(!_(t)||(e=t,S&&S in e))&&(m(t)?F:z).test(x(t));var e}function H(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return R(r)?r:void 0}var T=H(Object,"create"),I=Object.prototype.hasOwnProperty,M=Object.prototype.hasOwnProperty;function B(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function N(t,e){return t===e||t!=t&&e!=e}function U(t,e){for(var r=t.length;r--;)if(N(t[r][0],e))return r;return-1}B.prototype.clear=function(){this.__data__=T?T(null):{},this.size=0},B.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},B.prototype.get=function(t){var e=this.__data__;if(T){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return I.call(e,t)?e[t]:void 0},B.prototype.has=function(t){var e=this.__data__;return T?void 0!==e[t]:M.call(e,t)},B.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=T&&void 0===e?"__lodash_hash_undefined__":e,this};var D=Array.prototype.splice;function q(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}q.prototype.clear=function(){this.__data__=[],this.size=0},q.prototype.delete=function(t){var e=this.__data__,r=U(e,t);return!(r<0||(r==e.length-1?e.pop():D.call(e,r,1),--this.size,0))},q.prototype.get=function(t){var e=this.__data__,r=U(e,t);return r<0?void 0:e[r][1]},q.prototype.has=function(t){return U(this.__data__,t)>-1},q.prototype.set=function(t,e){var r=this.__data__,n=U(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var C=H(c,"Map");function L(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function W(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function G(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(G.Cache||W),r}W.prototype.clear=function(){this.size=0,this.__data__={hash:new B,map:new(C||q),string:new B}},W.prototype.delete=function(t){var e=L(this,t).delete(t);return this.size-=e?1:0,e},W.prototype.get=function(t){return L(this,t).get(t)},W.prototype.has=function(t){return L(this,t).has(t)},W.prototype.set=function(t,e){var r=L(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},G.Cache=W;var V,J,Q,K=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,X=/\\(\\)?/g,Y=(V=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(K,function(t,r,n,o){e.push(n?o.replace(X,"$1"):r||t)}),e},J=G(V,function(t){return 500===Q.size&&Q.clear(),t}),Q=J.cache,J),Z=Y,tt=a?a.prototype:void 0,et=tt?tt.toString:void 0;function rt(t){if("string"==typeof t)return t;if(o(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(t,rt)+"";if(d(t))return et?et.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function nt(t){return null==t?"":rt(t)}function ot(t,e){return o(t)?t:function(t,e){if(o(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!d(t))||j.test(t)||!g.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:Z(nt(t))}function it(t){if("string"==typeof t||d(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ut(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=ot(e,t)).length;null!=t&&r<n;)t=t[it(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}function ct(t){return nt(t).toLowerCase()}function at(t){var e=this.__data__=new q(t);this.size=e.size}at.prototype.clear=function(){this.__data__=new q,this.size=0},at.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},at.prototype.get=function(t){return this.__data__.get(t)},at.prototype.has=function(t){return this.__data__.has(t)},at.prototype.set=function(t,e){var r=this.__data__;if(r instanceof q){var n=r.__data__;if(!C||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new W(n)}return r.set(t,e),this.size=r.size,this};var ft=function(){try{var t=H(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),lt=ft;function st(t,e,r){"__proto__"==e&&lt?lt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var pt=Object.prototype.hasOwnProperty;function ht(t,e,r){var n=t[e];pt.call(t,e)&&N(n,r)&&(void 0!==r||e in t)||st(t,e,r)}function bt(t,e,r,n){var o=!r;r||(r={});for(var i=-1,u=e.length;++i<u;){var c=e[i],a=n?n(r[c],t[c],c,r,t):void 0;void 0===a&&(a=t[c]),o?st(r,c,a):ht(r,c,a)}return r}function yt(t){return v(t)&&"[object Arguments]"==y(t)}var vt=Object.prototype,dt=vt.hasOwnProperty,gt=vt.propertyIsEnumerable,jt=yt(function(){return arguments}())?yt:function(t){return v(t)&&dt.call(t,"callee")&&!gt.call(t,"callee")},_t=jt,mt=n&&!n.nodeType&&n,wt=mt&&t&&!t.nodeType&&t,Ot=wt&&wt.exports===mt?c.Buffer:void 0,St=(Ot?Ot.isBuffer:void 0)||function(){return!1},At=/^(?:0|[1-9]\d*)$/;function xt(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&At.test(t))&&t>-1&&t%1==0&&t<e}function zt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var $t={};function kt(t){return function(e){return t(e)}}$t["[object Float32Array]"]=$t["[object Float64Array]"]=$t["[object Int8Array]"]=$t["[object Int16Array]"]=$t["[object Int32Array]"]=$t["[object Uint8Array]"]=$t["[object Uint8ClampedArray]"]=$t["[object Uint16Array]"]=$t["[object Uint32Array]"]=!0,$t["[object Arguments]"]=$t["[object Array]"]=$t["[object ArrayBuffer]"]=$t["[object Boolean]"]=$t["[object DataView]"]=$t["[object Date]"]=$t["[object Error]"]=$t["[object Function]"]=$t["[object Map]"]=$t["[object Number]"]=$t["[object Object]"]=$t["[object RegExp]"]=$t["[object Set]"]=$t["[object String]"]=$t["[object WeakMap]"]=!1;var Et=n&&!n.nodeType&&n,Pt=Et&&t&&!t.nodeType&&t,Ft=Pt&&Pt.exports===Et&&i.process,Rt=function(){try{return Pt&&Pt.require&&Pt.require("util").types||Ft&&Ft.binding&&Ft.binding("util")}catch(t){}}(),Ht=Rt&&Rt.isTypedArray,Tt=Ht?kt(Ht):function(t){return v(t)&&zt(t.length)&&!!$t[y(t)]},It=Object.prototype.hasOwnProperty;function Mt(t,e){var r=o(t),n=!r&&_t(t),i=!r&&!n&&St(t),u=!r&&!n&&!i&&Tt(t),c=r||n||i||u,a=c?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],f=a.length;for(var l in t)!e&&!It.call(t,l)||c&&("length"==l||i&&("offset"==l||"parent"==l)||u&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||xt(l,f))||a.push(l);return a}var Bt=Object.prototype;function Nt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Bt)}function Ut(t,e){return function(r){return t(e(r))}}var Dt=Ut(Object.keys,Object),qt=Object.prototype.hasOwnProperty;function Ct(t){if(!Nt(t))return Dt(t);var e=[];for(var r in Object(t))qt.call(t,r)&&"constructor"!=r&&e.push(r);return e}function Lt(t){return null!=t&&zt(t.length)&&!m(t)}function Wt(t){return Lt(t)?Mt(t):Ct(t)}var Gt=Object.prototype.hasOwnProperty;function Vt(t){if(!_(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Nt(t),r=[];for(var n in t)("constructor"!=n||!e&&Gt.call(t,n))&&r.push(n);return r}function Jt(t){return Lt(t)?Mt(t,!0):Vt(t)}var Qt=n&&!n.nodeType&&n,Kt=Qt&&t&&!t.nodeType&&t,Xt=Kt&&Kt.exports===Qt?c.Buffer:void 0,Yt=Xt?Xt.allocUnsafe:void 0;function Zt(){return[]}var te=Object.prototype.propertyIsEnumerable,ee=Object.getOwnPropertySymbols,re=ee?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(ee(t),function(e){return te.call(t,e)}))}:Zt,ne=re;function oe(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var ie=Ut(Object.getPrototypeOf,Object),ue=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)oe(e,ne(t)),t=ie(t);return e}:Zt,ce=ue;function ae(t,e,r){var n=e(t);return o(t)?n:oe(n,r(t))}function fe(t){return ae(t,Wt,ne)}function le(t){return ae(t,Jt,ce)}var se=H(c,"DataView"),pe=H(c,"Promise"),he=H(c,"Set"),be=H(c,"WeakMap"),ye="[object Map]",ve="[object Promise]",de="[object Set]",ge="[object WeakMap]",je="[object DataView]",_e=x(se),me=x(C),we=x(pe),Oe=x(he),Se=x(be),Ae=y;(se&&Ae(new se(new ArrayBuffer(1)))!=je||C&&Ae(new C)!=ye||pe&&Ae(pe.resolve())!=ve||he&&Ae(new he)!=de||be&&Ae(new be)!=ge)&&(Ae=function(t){var e=y(t),r="[object Object]"==e?t.constructor:void 0,n=r?x(r):"";if(n)switch(n){case _e:return je;case me:return ye;case we:return ve;case Oe:return de;case Se:return ge}return e});var xe=Ae,ze=Object.prototype.hasOwnProperty,$e=c.Uint8Array;function ke(t){var e=new t.constructor(t.byteLength);return new $e(e).set(new $e(t)),e}var Ee=/\w*$/,Pe=a?a.prototype:void 0,Fe=Pe?Pe.valueOf:void 0;function Re(t,e,r){var n,o=t.constructor;switch(e){case"[object ArrayBuffer]":return ke(t);case"[object Boolean]":case"[object Date]":return new o(+t);case"[object DataView]":return function(t,e){var r=e?ke(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(t,e){var r=e?ke(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,r);case"[object Map]":case"[object Set]":return new o;case"[object Number]":case"[object String]":return new o(t);case"[object RegExp]":return function(t){var e=new t.constructor(t.source,Ee.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return n=t,Fe?Object(Fe.call(n)):{}}}var He=Object.create,Te=function(){function t(){}return function(e){if(!_(e))return{};if(He)return He(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),Ie=Te,Me=Rt&&Rt.isMap,Be=Me?kt(Me):function(t){return v(t)&&"[object Map]"==xe(t)},Ne=Rt&&Rt.isSet,Ue=Ne?kt(Ne):function(t){return v(t)&&"[object Set]"==xe(t)},De="[object Arguments]",qe="[object Function]",Ce="[object Object]",Le={};function We(t,e,r,n,i,u){var c,a=1&e,f=2&e,l=4&e;if(r&&(c=i?r(t,n,i,u):r(t)),void 0!==c)return c;if(!_(t))return t;var s=o(t);if(s){if(c=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&ze.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!a)return function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t,c)}else{var p=xe(t),h=p==qe||"[object GeneratorFunction]"==p;if(St(t))return function(t,e){if(e)return t.slice();var r=t.length,n=Yt?Yt(r):new t.constructor(r);return t.copy(n),n}(t,a);if(p==Ce||p==De||h&&!i){if(c=f||h?{}:function(t){return"function"!=typeof t.constructor||Nt(t)?{}:Ie(ie(t))}(t),!a)return f?function(t,e){return bt(t,ce(t),e)}(t,function(t,e){return t&&bt(e,Jt(e),t)}(c,t)):function(t,e){return bt(t,ne(t),e)}(t,function(t,e){return t&&bt(e,Wt(e),t)}(c,t))}else{if(!Le[p])return i?t:{};c=Re(t,p,a)}}u||(u=new at);var b=u.get(t);if(b)return b;u.set(t,c),Ue(t)?t.forEach(function(n){c.add(We(n,e,r,n,t,u))}):Be(t)&&t.forEach(function(n,o){c.set(o,We(n,e,r,o,t,u))});var y=s?void 0:(l?f?le:fe:f?Jt:Wt)(t);return function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););}(y||t,function(n,o){y&&(n=t[o=n]),ht(c,o,We(n,e,r,o,t,u))}),c}function Ge(t){return We(t,5)}function Ve(t){return!(!function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)||""===t)}function Je(t){let e=!1;if(Ve(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(function(t){return t!=t}(t))return!1;e=!0}return e}function Qe(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function Ke(t){return!0===(e=t)||!1===e||v(e)&&"[object Boolean]"==y(e);var e}function Xe(t){let e,r=Object.prototype.toString.call(t);if(e="[object Promise]"===r,e)return!0;if("[object Function]"!==r)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}Le[De]=Le["[object Array]"]=Le["[object ArrayBuffer]"]=Le["[object DataView]"]=Le["[object Boolean]"]=Le["[object Date]"]=Le["[object Float32Array]"]=Le["[object Float64Array]"]=Le["[object Int8Array]"]=Le["[object Int16Array]"]=Le["[object Int32Array]"]=Le["[object Map]"]=Le["[object Number]"]=Le[Ce]=Le["[object RegExp]"]=Le["[object Set]"]=Le["[object String]"]=Le["[object Symbol]"]=Le["[object Uint8Array]"]=Le["[object Uint8ClampedArray]"]=Le["[object Uint16Array]"]=Le["[object Uint32Array]"]=!0,Le["[object Error]"]=Le[qe]=Le["[object WeakMap]"]=!1;var Ye=/\s/,Ze=/^\s+/;function tr(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Ye.test(t.charAt(e)););return e}(t)+1).replace(Ze,""):t}var er=/^[-+]0x[0-9a-f]+$/i,rr=/^0b[01]+$/i,nr=/^0o[0-7]+$/i,or=parseInt;function ir(t){if("number"==typeof t)return t;if(d(t))return NaN;if(_(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=_(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=tr(t);var r=rr.test(t);return r||nr.test(t)?or(t.slice(2),r?2:8):er.test(t)?NaN:+t}var ur=1/0;function cr(t){return t?(t=ir(t))===ur||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ar(t){var e=cr(t),r=e%1;return e==e?r?e-r:e:0}var fr=c.isFinite,lr=Math.min,sr=function(){var t=Math.round;return function(e,r){if(e=ir(e),(r=null==r?0:lr(ar(r),292))&&fr(e)){var n=(nt(e)+"e").split("e");return+((n=(nt(t(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}}(),pr=sr;function hr(t){return Je(t)?cr(t):0}function br(t){if(!Je(t))return 0;t=hr(t);let e=pr(t);return"0"===String(e)?0:e}function yr(t,e){return r=t,"[object Object]"===Object.prototype.toString.call(r)&&!(!Ve(e)&&!Je(e))&&e in t;var r}function vr(t,e,r){var n=t.length;return r=void 0===r?n:r,!e&&r>=n?t:function(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+e];return i}(t,e,r)}var dr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function gr(t){return dr.test(t)}var jr=Rt&&Rt.isRegExp,_r=jr?kt(jr):function(t){return v(t)&&"[object RegExp]"==y(t)},mr="\\ud800-\\udfff",wr="["+mr+"]",Or="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Sr="\\ud83c[\\udffb-\\udfff]",Ar="[^"+mr+"]",xr="(?:\\ud83c[\\udde6-\\uddff]){2}",zr="[\\ud800-\\udbff][\\udc00-\\udfff]",$r="(?:"+Or+"|"+Sr+")?",kr="[\\ufe0e\\ufe0f]?",Er=kr+$r+"(?:\\u200d(?:"+[Ar,xr,zr].join("|")+")"+kr+$r+")*",Pr="(?:"+[Ar+Or+"?",Or,xr,zr,wr].join("|")+")",Fr=RegExp(Sr+"(?="+Sr+")|"+Pr+Er,"g");function Rr(t){return gr(t)?function(t){return t.match(Fr)||[]}(t):function(t){return t.split("")}(t)}function Hr(t,e,r){return r&&"number"!=typeof r&&function(t,e,r){if(!_(r))return!1;var n=typeof e;return!!("number"==n?Lt(r)&&xt(e,r.length):"string"==n&&e in r)&&N(r[e],t)}(t,e,r)&&(e=r=void 0),(r=void 0===r?4294967295:r>>>0)?(t=nt(t))&&("string"==typeof e||null!=e&&!_r(e))&&!(e=rt(e))&&gr(t)?vr(Rr(t),0,r):t.split(e,r):[]}var Tr,Ir=(Tr="length",function(t){return null==t?void 0:t[Tr]}),Mr="\\ud800-\\udfff",Br="["+Mr+"]",Nr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ur="\\ud83c[\\udffb-\\udfff]",Dr="[^"+Mr+"]",qr="(?:\\ud83c[\\udde6-\\uddff]){2}",Cr="[\\ud800-\\udbff][\\udc00-\\udfff]",Lr="(?:"+Nr+"|"+Ur+")?",Wr="[\\ufe0e\\ufe0f]?",Gr=Wr+Lr+"(?:\\u200d(?:"+[Dr,qr,Cr].join("|")+")"+Wr+Lr+")*",Vr="(?:"+[Dr+Nr+"?",Nr,qr,Cr,Br].join("|")+")",Jr=RegExp(Ur+"(?="+Ur+")|"+Vr+Gr,"g");function Qr(t){return gr(t)?function(t){for(var e=Jr.lastIndex=0;Jr.test(t);)++e;return e}(t):Ir(t)}function Kr(t){if(null==t)return 0;if(Lt(t))return"string"==typeof(e=t)||!o(e)&&v(e)&&"[object String]"==y(e)?Qr(t):t.length;var e,r=xe(t);return"[object Map]"==r||"[object Set]"==r?t.size:Ct(t).length}function Xr(t){return!!Je(t)&&"number"==typeof(e=t=hr(t))&&e==ar(e);var e}function Yr(t){return!!Xr(t)&&br(t)>=0}function Zr(t,e){if(!Ve(t))return"";if(!Yr(e))return"";if(0===(e=br(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}function tn(t,e){return Ve(t)&&Yr(e)?0===(e=br(e))?t:function(t,e){return Ve(t)&&Yr(e)?0===(e=br(e))?"":t.substring(0,e):""}(t,t.length-e):""}function en(t){if(!Ve(t))return"";let e=function(t){if(!Ve(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===Zr(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===Zr(t,1)){let e=tn(t,1);return":"===Zr(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===Zr(t,1)){let e=tn(t,1);return 0===e.length?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}(t);if(e.isRoot)return e.path;let r=e.path;try{r=r.split("\\").pop().split("/").pop()}catch(t){}return r}function rn(t){return function(t,e={}){let r=ut(e,"fs");return!!r.existsSync(t)&&!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink()}(t,{fs:e})}let nn=(t,e)=>{let r=t.toString("base64"),n=(t=>"png"===(t=ct(t))?"image/png":"jpg"===t||"jpeg"===t?"image/jpeg":"gif"===t?"image/gif":"svg"===t?"image/svg+xml":"webp"===t?"image/webp":"application/octet-stream")(e);return`data:${n};base64,${r}`},on=async(t,n,o={})=>{if(!rn(t))throw new Error(`fpInp[${t}] does not exist`);let i=ut(o,"funGetWidth"),u=ut(o,"funGetHeight"),c=ut(o,"funGetSize"),a=ut(o,"cropLeft"),f=ut(o,"cropTop"),l=ut(o,"cropWidth"),s=ut(o,"cropHeight"),p=ut(o,"density");Je(p)||(p=96),p=br(p);let h=ut(o,"returnBase64");Ke(h)||(h=!1);let b=function(t){if(!Ve(t))return"";let e=Hr(en(t),".");if(Kr(e)<=1)return"";let r="";try{r=(o=null==(n=e)?0:n.length)?n[o-1]:void 0}catch(t){}var n,o;return r}(n);b=ct(b);let y=e.readFileSync(t),v=null,d=null;if(Qe(c)||Qe(i)||Qe(u)){let t=await r(y).metadata();if(Qe(c)){let e=c(Ge(t));if(Xe(e)&&(e=await e),!Je(ut(e,"width")))throw new Error("invalid ret.width for funGetSize");if(!Je(ut(e,"height")))throw new Error("invalid ret.height for funGetSize");v=br(e.width),d=br(e.height)}else Qe(i)?(v=i(Ge(t)),Xe(v)&&(v=await v),v=br(v)):Qe(u)&&(d=u(Ge(t)),Xe(d)&&(d=await d),d=br(d))}let g=await r(y,{density:p}),j=Je(v),_=Je(d),m=Je(a)&&Je(f)&&Je(l)&&Je(s);j&&_?g=g.resize({width:v,height:d,withoutEnlargement:!0}):j&&!_?g=g.resize({width:v,withoutEnlargement:!0}):!j&&_&&(g=g.resize({height:d,withoutEnlargement:!0})),m&&(a=br(a),f=br(f),l=br(l),s=br(s),g=g.extract({left:a,top:f,width:l,height:s}));let w={png:()=>g.png({compressionLevel:9,adaptiveFiltering:!1,palette:!1,quality:100,colors:256,...o}),jpg:()=>g.flatten({background:ut(o,"background","#fff")}).jpeg({quality:100,progressive:!1,chromaSubsampling:"4:2:0",optimiseCoding:!0,mozjpeg:!1,overshootDeringing:!1,...o}),jpeg:()=>g.flatten({background:ut(o,"background","#fff")}).jpeg({quality:100,progressive:!1,chromaSubsampling:"4:2:0",optimiseCoding:!0,mozjpeg:!1,overshootDeringing:!1,...o}),webp:()=>g.webp({quality:100,alphaQuality:100,lossless:!0,...o}),avif:()=>g.avif({quality:50,lossless:!1,speed:5,chromaSubsampling:"4:2:0",...o}),gif:()=>g.gif({effort:7,interlace:!1,...o}),tiff:()=>g.tiff({quality:100,compression:"jpeg",predictor:"horizontal",pyramid:!1,tile:!1,...o}),bmp:()=>g.bmp({...o})};g=yr(w,b)?w[b]():g.toFormat(b);let O=await g.toBuffer();return h?nn(O,b):(e.writeFileSync(n,O),"ok")};return{proc:on,convert:async(t,e,r={})=>{let n={...r,cropLeft:null,cropTop:null,cropWidth:null,cropHeight:null,funGetWidth:null,funGetHeight:null,funGetSize:null,returnBase64:!1};return await on(t,e,n)},resize:async(t,e,r={})=>{let n={...r,cropLeft:null,cropTop:null,cropWidth:null,cropHeight:null,returnBase64:!1};return await on(t,e,n)},crop:async(t,e,r,n,o,i,u={})=>{let c={...u,cropLeft:e,cropTop:r,cropWidth:n,cropHeight:o,funGetWidth:null,funGetHeight:null,funGetSize:null,returnBase64:!1};return await on(t,i,c)},base64:async(t,e,r={})=>{let n={...r,cropLeft:null,cropTop:null,cropWidth:null,cropHeight:null,returnBase64:!0};return await on(t,`${t}.${e}`,n)}}}(e,r)}(_n,_n.exports);var mn=jn(_n.exports);return async function(r,a,f={}){if(!dn(r))return Promise.reject(`fpIn[${r}] does not exist`);let p=vn(r=t.resolve(r)),h=vt(f,"fpInTemp");if(!dn(h)){let t="./src/html.tmp",e="./node_modules/w-md2html/src/html.tmp";if(dn(t))h=t;else{if(!dn(e))throw new Error(`fpInTemp[${h}] does not exist`);h=e}}h=t.resolve(h);let b=vt(f,"imgWidthMax",null);Yr(b)&&(b=`${b}px`);let y=vt(f,"imgConvertToBase64",null);Wr(y)||(y=!0);let v=vt(f,"funProcFpOut"),d=(t,e)=>{let r=pr(t,"\n"),n=0,o=[],i={};Zt(r,t=>{let r=t;if(t.indexOf(`${e}n`)>=0){let o;n++,r=en(t,`${e}n`,`${e}${n}`),o=t,o=en(o,'<div style="margin:1rem 0;">',""),o=en(o,"</div>",""),o=en(o,`${e}n`,""),o=gr(o),o=`{${o}}`,i[o]=`${e}${n}`}o.push(r)});let u=_r(o,"\n");return Zt(i,(t,e)=>{u=u.replaceAll(e,t)}),u},g=vt(f,"fontFamilies",[]);var j,_,m;(!Jr(j=g)||0===j.length||1===j.length&&Xr(j[0]))&&(g=["Microsoft JhengHei","Avenir","Helvetica","Arial","sans-serif"]),g=_r((m=t=>`'${t}'`,(s(_=g)?at:Ge)(_,We(m))),", ");let w=vt(f,"fontSizeUnit","");Vr(w)||(w="pt");let O=vt(f,"fontSizeScale","");Yr(O)||(O=1),O=tn(O);let S=vt(f,"fontSizeDef","");Vr(S)||(S=12*O+w);let A=vt(f,"fontSizeH1","");Vr(A)||(A=20*O+w);let x=vt(f,"fontSizeH2","");Vr(x)||(x=16*O+w);let z=vt(f,"fontSizeH3","");Vr(z)||(z=14*O+w);let $=vt(f,"fontSizeH4","");Vr($)||($=12*O+w);let k=vt(f,"fontSizeH5","");Vr(k)||(k=12*O+w);let E=vt(f,"fontSizeH6","");Vr(E)||(E=12*O+w);let P=vt(f,"fontSizeP","");Vr(P)||(P=12*O+w);let F=vt(f,"fontSizeTab","");Vr(F)||(F=11*O+w);let R=vt(f,"fontSizeCode","");Vr(R)||(R=10*O+w);let H=vt(f,"textAlignH1","");Vr(H)||(H="left");let T=vt(f,"textAlignH2","");Vr(T)||(T="left");let I=vt(f,"textAlignH3","");Vr(I)||(I="left");let M=vt(f,"textAlignH4","");Vr(M)||(M="left");let B=vt(f,"textAlignH5","");Vr(B)||(B="left");let N=vt(f,"textAlignH6","");Vr(N)||(N="left");let U=e.readFileSync(h,"utf8"),D=yn(r),q=vn(r),C=e.readFileSync(r,"utf8"),L=(t=>{let e=pr(t,"\n"),r="";return Zt(e,(t,n)=>{if(t.indexOf(" pretitle ")>=0)return r=vt(e,n+1,""),r=gr(r),!1}),r})(C);C=d(C,"圖"),C=d(C,"表"),C=await(async(t,e)=>{let r=[],n=pr(e,"\n");return await rn(n,async e=>{e.indexOf('src="')>=0&&(e=await(async e=>{let r=pr(e,'src="');if(2!==Lr(r))throw new Error("size(s)!==2");let n=r[0],o=pr(r[1],'"'),i=o[0],u="";if(dn(i))u=i;else if(u=`${t}/${i}`,!dn(u))throw console.log("c",e),console.log("fnp",i),new Error(`fp[${u}] does not exist`);let c=await mn.base64(u,"png");return o=kr(o),n+'src="'+c+'"'+_r(o,'"')})(e)),r.push(e)}),r=_r(r,"\n"),r})(q,C);let W=new n.Marked;W.use(o({throwOnError:!1,nonStandard:!0})),W.use(i()),W.use(c.markedHighlight({langPrefix:"hljs language-",emptyLangClass:"hljs",highlight(t,e){let r=e&&u.getLanguage(e)?e:"plaintext";return u.highlight(t,{language:r}).value}}));let G={image:({href:t,title:e,text:r})=>{let n=Vr(e)?`title="${e}"`:"",o="";return Vr(b)&&(o=`max-width:${b}; height:auto;`),`<img src="${t}" alt="${r}" ${n} style="${o}">`}};W.use({async:!0,renderer:G,walkTokens:async e=>{if("image"===e.type&&y)try{let r=t.resolve(p,e.href);dn(r)?e.href=await mn.base64(r,"png"):console.log(`href[${e.href}] does not exist`)}catch(t){console.log(t)}}});let V=U;return V=en(V,"{html}",await W.parse(C)),V=en(V,"{title}",D),V=en(V,"{fontFamilies}",g),V=en(V,"{fontSizeDef}",S),V=en(V,"{fontSizeH1}",A),V=en(V,"{fontSizeH2}",x),V=en(V,"{fontSizeH3}",z),V=en(V,"{fontSizeH4}",$),V=en(V,"{fontSizeH5}",k),V=en(V,"{fontSizeH6}",E),V=en(V,"{fontSizeP}",P),V=en(V,"{fontSizeTab}",F),V=en(V,"{fontSizeCode}",R),V=en(V,"{textAlignH1}",H),V=en(V,"{textAlignH2}",T),V=en(V,"{textAlignH3}",I),V=en(V,"{textAlignH4}",M),V=en(V,"{textAlignH5}",B),V=en(V,"{textAlignH6}",N),V=en(V,'<h2 id="footnote-label" class="sr-only">Footnotes</h2>','<h2 id="footnote-label" class="sr-only" style="height:0px; line-height:0px; min-height:0px; overflow:hidden;">Footnotes</h2>'),V=V.replaceAll("<li>",'<li style="margin:7px 0;">'),V=(t=>{const e=l.load(t);return e('[style*="display:none"]').remove(),e.html()})(V),Zr(v)&&function(t){let e,r=Object.prototype.toString.call(t);if(e="[object Promise]"===r,e)return!0;if("[object Function]"!==r)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}(a=v({fpOut:a,pretitle:L}))&&(a=await a),e.writeFileSync(a,V,"utf8"),"ok"}});
//# sourceMappingURL=w-md2html.umd.js.map
