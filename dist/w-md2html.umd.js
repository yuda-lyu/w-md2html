/*!
 * w-md2html v1.0.27
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs"),require("sharp"),require("marked"),require("marked-katex-extension"),require("marked-footnote"),require("highlight.js"),require("marked-highlight"),require("cheerio")):"function"==typeof define&&define.amd?define(["path","fs","sharp","marked","marked-katex-extension","marked-footnote","highlight.js","marked-highlight","cheerio"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-md2html"]=e(t.path,t.fs,t.sharp,t.marked,t["marked-katex-extension"],t["marked-footnote"],t.highlight.js,t["marked-highlight"],t.cheerio)}(this,function(t,e,n,r,i,o,a,l,c){"use strict";function s(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}),e.default=t,Object.freeze(e)}var u=s(c),f=Array.isArray,p="object"==typeof global&&global&&global.Object===Object&&global,h="object"==typeof self&&self&&self.Object===Object&&self,d=p||h||Function("return this")(),m=d.Symbol,g=Object.prototype,y=g.hasOwnProperty,b=g.toString,_=m?m.toStringTag:void 0;var v=Object.prototype.toString;var w=m?m.toStringTag:void 0;function T(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":w&&w in Object(t)?function(t){var e=y.call(t,_),n=t[_];try{t[_]=void 0;var r=!0}catch(t){}var i=b.call(t);return r&&(e?t[_]=n:delete t[_]),i}(t):function(t){return v.call(t)}(t)}function S(t){return null!=t&&"object"==typeof t}function A(t){return"symbol"==typeof t||S(t)&&"[object Symbol]"==T(t)}var E=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,x=/^\w*$/;function j(t,e){if(f(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!A(t))||(x.test(t)||!E.test(t)||null!=e&&t in Object(e))}function k(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function O(t){if(!k(t))return!1;var e=T(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var N,C=d["__core-js_shared__"],D=(N=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+N:"";var R=Function.prototype.toString;function z(t){if(null!=t){try{return R.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var L=/^\[object .+?Constructor\]$/,I=Function.prototype,M=Object.prototype,H=I.toString,P=M.hasOwnProperty,B=RegExp("^"+H.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function F(t){return!(!k(t)||(e=t,D&&D in e))&&(O(t)?B:L).test(z(t));var e}function U(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return F(n)?n:void 0}var $=U(Object,"create");var W=Object.prototype.hasOwnProperty;var G=Object.prototype.hasOwnProperty;function q(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Y(t,e){return t===e||t!=t&&e!=e}function X(t,e){for(var n=t.length;n--;)if(Y(t[n][0],e))return n;return-1}q.prototype.clear=function(){this.__data__=$?$(null):{},this.size=0},q.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},q.prototype.get=function(t){var e=this.__data__;if($){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return W.call(e,t)?e[t]:void 0},q.prototype.has=function(t){var e=this.__data__;return $?void 0!==e[t]:G.call(e,t)},q.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=$&&void 0===e?"__lodash_hash_undefined__":e,this};var V=Array.prototype.splice;function K(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}K.prototype.clear=function(){this.__data__=[],this.size=0},K.prototype.delete=function(t){var e=this.__data__,n=X(e,t);return!(n<0)&&(n==e.length-1?e.pop():V.call(e,n,1),--this.size,!0)},K.prototype.get=function(t){var e=this.__data__,n=X(e,t);return n<0?void 0:e[n][1]},K.prototype.has=function(t){return X(this.__data__,t)>-1},K.prototype.set=function(t,e){var n=this.__data__,r=X(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};var J=U(d,"Map");function Z(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Q(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Q.prototype.clear=function(){this.size=0,this.__data__={hash:new q,map:new(J||K),string:new q}},Q.prototype.delete=function(t){var e=Z(this,t).delete(t);return this.size-=e?1:0,e},Q.prototype.get=function(t){return Z(this,t).get(t)},Q.prototype.has=function(t){return Z(this,t).has(t)},Q.prototype.set=function(t,e){var n=Z(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function tt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(tt.Cache||Q),n}tt.Cache=Q;var et,nt,rt,it=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ot=/\\(\\)?/g,at=(et=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(it,function(t,n,r,i){e.push(r?i.replace(ot,"$1"):n||t)}),e},nt=tt(et,function(t){return 500===rt.size&&rt.clear(),t}),rt=nt.cache,nt),lt=at;function ct(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var st=m?m.prototype:void 0,ut=st?st.toString:void 0;function ft(t){if("string"==typeof t)return t;if(f(t))return ct(t,ft)+"";if(A(t))return ut?ut.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function pt(t){return null==t?"":ft(t)}function ht(t,e){return f(t)?t:j(t,e)?[t]:lt(pt(t))}function dt(t){if("string"==typeof t||A(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function mt(t,e){for(var n=0,r=(e=ht(e,t)).length;null!=t&&n<r;)t=t[dt(e[n++])];return n&&n==r?t:void 0}function gt(t,e,n){var r=null==t?void 0:mt(t,e);return void 0===r?n:r}function yt(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}var bt,_t=function(t,e,n){for(var r=-1,i=Object(t),o=n(t),a=o.length;a--;){var l=o[bt?a:++r];if(!1===e(i[l],l,i))break}return t};function vt(t){return S(t)&&"[object Arguments]"==T(t)}var wt=Object.prototype,Tt=wt.hasOwnProperty,St=wt.propertyIsEnumerable,At=vt(function(){return arguments}())?vt:function(t){return S(t)&&Tt.call(t,"callee")&&!St.call(t,"callee")},Et=At;var xt="object"==typeof exports&&exports&&!exports.nodeType&&exports,jt=xt&&"object"==typeof module&&module&&!module.nodeType&&module,kt=jt&&jt.exports===xt?d.Buffer:void 0,Ot=(kt?kt.isBuffer:void 0)||function(){return!1},Nt=/^(?:0|[1-9]\d*)$/;function Ct(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&Nt.test(t))&&t>-1&&t%1==0&&t<e}function Dt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var Rt={};function zt(t){return function(e){return t(e)}}Rt["[object Float32Array]"]=Rt["[object Float64Array]"]=Rt["[object Int8Array]"]=Rt["[object Int16Array]"]=Rt["[object Int32Array]"]=Rt["[object Uint8Array]"]=Rt["[object Uint8ClampedArray]"]=Rt["[object Uint16Array]"]=Rt["[object Uint32Array]"]=!0,Rt["[object Arguments]"]=Rt["[object Array]"]=Rt["[object ArrayBuffer]"]=Rt["[object Boolean]"]=Rt["[object DataView]"]=Rt["[object Date]"]=Rt["[object Error]"]=Rt["[object Function]"]=Rt["[object Map]"]=Rt["[object Number]"]=Rt["[object Object]"]=Rt["[object RegExp]"]=Rt["[object Set]"]=Rt["[object String]"]=Rt["[object WeakMap]"]=!1;var Lt="object"==typeof exports&&exports&&!exports.nodeType&&exports,It=Lt&&"object"==typeof module&&module&&!module.nodeType&&module,Mt=It&&It.exports===Lt&&p.process,Ht=function(){try{var t=It&&It.require&&It.require("util").types;return t||Mt&&Mt.binding&&Mt.binding("util")}catch(t){}}(),Pt=Ht&&Ht.isTypedArray,Bt=Pt?zt(Pt):function(t){return S(t)&&Dt(t.length)&&!!Rt[T(t)]},Ft=Object.prototype.hasOwnProperty;function Ut(t,e){var n=f(t),r=!n&&Et(t),i=!n&&!r&&Ot(t),o=!n&&!r&&!i&&Bt(t),a=n||r||i||o,l=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=l.length;for(var s in t)!e&&!Ft.call(t,s)||a&&("length"==s||i&&("offset"==s||"parent"==s)||o&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Ct(s,c))||l.push(s);return l}var $t=Object.prototype;function Wt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||$t)}function Gt(t,e){return function(n){return t(e(n))}}var qt=Gt(Object.keys,Object),Yt=Object.prototype.hasOwnProperty;function Xt(t){if(!Wt(t))return qt(t);var e=[];for(var n in Object(t))Yt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Vt(t){return null!=t&&Dt(t.length)&&!O(t)}function Kt(t){return Vt(t)?Ut(t):Xt(t)}var Jt=function(t,e){return function(n,r){if(null==n)return n;if(!Vt(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=Object(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}(function(t,e){return t&&_t(t,e,Kt)}),Zt=Jt;function Qt(t){return t}function te(t,e){var n;return(f(t)?yt:Zt)(t,"function"==typeof(n=e)?n:Qt)}function ee(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o}function ne(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:ee(t,e,n)}var re=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function ie(t){return re.test(t)}var oe=Ht&&Ht.isRegExp,ae=oe?zt(oe):function(t){return S(t)&&"[object RegExp]"==T(t)};var le="\\ud800-\\udfff",ce="["+le+"]",se="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ue="\\ud83c[\\udffb-\\udfff]",fe="[^"+le+"]",pe="(?:\\ud83c[\\udde6-\\uddff]){2}",he="[\\ud800-\\udbff][\\udc00-\\udfff]",de="(?:"+se+"|"+ue+")"+"?",me="[\\ufe0e\\ufe0f]?",ge=me+de+("(?:\\u200d(?:"+[fe,pe,he].join("|")+")"+me+de+")*"),ye="(?:"+[fe+se+"?",se,pe,he,ce].join("|")+")",be=RegExp(ue+"(?="+ue+")|"+ye+ge,"g");function _e(t){return ie(t)?function(t){return t.match(be)||[]}(t):function(t){return t.split("")}(t)}function ve(t,e,n){return n&&"number"!=typeof n&&function(t,e,n){if(!k(n))return!1;var r=typeof e;return!!("number"==r?Vt(n)&&Ct(e,n.length):"string"==r&&e in n)&&Y(n[e],t)}(t,e,n)&&(e=n=void 0),(n=void 0===n?4294967295:n>>>0)?(t=pt(t))&&("string"==typeof e||null!=e&&!ae(e))&&!(e=ft(e))&&ie(t)?ne(_e(t),0,n):t.split(e,n):[]}var we=/\s/;var Te=/^\s+/;function Se(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&we.test(t.charAt(e)););return e}(t)+1).replace(Te,""):t}function Ae(t){return t!=t}function Ee(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):function(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}(t,Ae,n)}function xe(t,e,n){if((t=pt(t))&&(n||void 0===e))return Se(t);if(!t||!(e=ft(e)))return t;var r=_e(t),i=_e(e),o=function(t,e){for(var n=-1,r=t.length;++n<r&&Ee(e,t[n],0)>-1;);return n}(r,i),a=function(t,e){for(var n=t.length;n--&&Ee(e,t[n],0)>-1;);return n}(r,i)+1;return ne(r,o,a).join("")}var je=Array.prototype.join;function ke(t,e){return null==t?"":je.call(t,e)}var Oe=/^[-+]0x[0-9a-f]+$/i,Ne=/^0b[01]+$/i,Ce=/^0o[0-7]+$/i,De=parseInt;function Re(t){if("number"==typeof t)return t;if(A(t))return NaN;if(k(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=k(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Se(t);var n=Ne.test(t);return n||Ce.test(t)?De(t.slice(2),n?2:8):Oe.test(t)?NaN:+t}var ze=1/0;function Le(t){return t?(t=Re(t))===ze||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function Ie(t){var e=Le(t),n=e%1;return e==e?n?e-n:e:0}function Me(t,e,n){var r=null==t?0:t.length;return r?ee(t,(e=n||void 0===e?1:Ie(e))<0?0:e,r):[]}var He=U(d,"DataView"),Pe=U(d,"Promise"),Be=U(d,"Set"),Fe=U(d,"WeakMap"),Ue="[object Map]",$e="[object Promise]",We="[object Set]",Ge="[object WeakMap]",qe="[object DataView]",Ye=z(He),Xe=z(J),Ve=z(Pe),Ke=z(Be),Je=z(Fe),Ze=T;(He&&Ze(new He(new ArrayBuffer(1)))!=qe||J&&Ze(new J)!=Ue||Pe&&Ze(Pe.resolve())!=$e||Be&&Ze(new Be)!=We||Fe&&Ze(new Fe)!=Ge)&&(Ze=function(t){var e=T(t),n="[object Object]"==e?t.constructor:void 0,r=n?z(n):"";if(r)switch(r){case Ye:return qe;case Xe:return Ue;case Ve:return $e;case Ke:return We;case Je:return Ge}return e});var Qe=Ze;function tn(t){return function(e){return null==e?void 0:e[t]}}var en=tn("length"),nn="\\ud800-\\udfff",rn="["+nn+"]",on="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",an="\\ud83c[\\udffb-\\udfff]",ln="[^"+nn+"]",cn="(?:\\ud83c[\\udde6-\\uddff]){2}",sn="[\\ud800-\\udbff][\\udc00-\\udfff]",un="(?:"+on+"|"+an+")"+"?",fn="[\\ufe0e\\ufe0f]?",pn=fn+un+("(?:\\u200d(?:"+[ln,cn,sn].join("|")+")"+fn+un+")*"),hn="(?:"+[ln+on+"?",on,cn,sn,rn].join("|")+")",dn=RegExp(an+"(?="+an+")|"+hn+pn,"g");function mn(t){return ie(t)?function(t){for(var e=dn.lastIndex=0;dn.test(t);)++e;return e}(t):en(t)}function gn(t){if(null==t)return 0;if(Vt(t))return"string"==typeof(e=t)||!f(e)&&S(e)&&"[object String]"==T(e)?mn(t):t.length;var e,n=Qe(t);return"[object Map]"==n||"[object Set]"==n?t.size:Xt(t).length}function yn(t){return!0===(e=t)||!1===e||S(e)&&"[object Boolean]"==T(e);var e}function bn(t){return"[object String]"===Object.prototype.toString.call(t)}function _n(t){return!(!bn(t)||""===t)}function vn(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function wn(t){let e,n=Object.prototype.toString.call(t);if(e="[object Promise]"===n,e)return!0;if("[object Function]"!==n)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}function Tn(t,e,n){if(!_n(t))return"";if(!_n(e))return"";if(!bn(n))return"";return String(t).replaceAll(e,n)}function Sn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var An={exports:{}};!function(t,e){!function(){if("string"!=typeof __filename||"string"!=typeof __dirname){if(this.Tautologistics){if(this.Tautologistics.NodeHtmlParser)return}else this.Tautologistics={};this.Tautologistics.NodeHtmlParser={},e=this.Tautologistics.NodeHtmlParser}var t,n,r,i={Text:"text",Directive:"directive",Comment:"comment",Script:"script",Style:"style",Tag:"tag"};function o(t,e){this._options=e||{},null==this._options.includeLocation&&(this._options.includeLocation=!1),this.validateHandler(t),this._handler=t,this.reset()}function a(t){a.super_.call(this,t,{ignoreWhitespace:!0,verbose:!1,enforceEmptyTags:!1})}function l(t,e){this.reset(),this._options=e||{},null==this._options.ignoreWhitespace&&(this._options.ignoreWhitespace=!1),null==this._options.verbose&&(this._options.verbose=!0),null==this._options.enforceEmptyTags&&(this._options.enforceEmptyTags=!0),"function"==typeof t&&(this._callback=t)}o._reTrim=/(^\s+|\s+$)/g,o._reTrimComment=/(^\!--|--$)/g,o._reWhitespace=/\s/g,o._reTagName=/^\s*(\/?)\s*([^\s\/]+)/,o._reAttrib=/([^=<>\"\'\s]+)\s*=\s*"([^"]*)"|([^=<>\"\'\s]+)\s*=\s*'([^']*)'|([^=<>\"\'\s]+)\s*=\s*([^'"\s]+)|([^=<>\"\'\s\/]+)/g,o._reTags=/[\<\>]/g,o.prototype.parseComplete=function(t){this.reset(),this.parseChunk(t),this.done()},o.prototype.parseChunk=function(t){this._done&&this.handleError(new Error("Attempted to parse chunk after parsing already done")),this._buffer+=t,this.parseTags()},o.prototype.done=function(){if(!this._done){if(this._done=!0,this._buffer.length){var t=this._buffer;this._buffer="";var e={raw:t,data:this._parseState==i.Text?t:t.replace(o._reTrim,""),type:this._parseState};this._parseState!=i.Tag&&this._parseState!=i.Script&&this._parseState!=i.Style||(e.name=this.parseTagName(e.data)),this.parseAttribs(e),this._elements.push(e)}this.writeHandler(),this._handler.done()}},o.prototype.reset=function(){this._buffer="",this._done=!1,this._elements=[],this._elementsCurrent=0,this._current=0,this._next=0,this._location={row:0,col:0,charOffset:0,inBuffer:0},this._parseState=i.Text,this._prevTagSep="",this._tagStack=[],this._handler.reset()},o.prototype._options=null,o.prototype._handler=null,o.prototype._buffer=null,o.prototype._done=!1,o.prototype._elements=null,o.prototype._elementsCurrent=0,o.prototype._current=0,o.prototype._next=0,o.prototype._location=null,o.prototype._parseState=i.Text,o.prototype._prevTagSep="",o.prototype._tagStack=null,o.prototype.parseTagAttribs=function(t){for(var e=t.length,n=0;n<e;){var r=t[n++];r.type!=i.Tag&&r.type!=i.Script&&r.type!=i.style||this.parseAttribs(r)}return t},o.prototype.parseAttribs=function(t){if(t.type==i.Script||t.type==i.Style||t.type==i.Tag){var e,n=t.data.split(o._reWhitespace,1)[0],r=t.data.substring(n.length);if(!(r.length<1))for(o._reAttrib.lastIndex=0;e=o._reAttrib.exec(r);)null==t.attribs&&(t.attribs={}),"string"==typeof e[1]&&e[1].length?t.attribs[e[1]]=e[2]:"string"==typeof e[3]&&e[3].length?t.attribs[e[3].toString()]=e[4].toString():"string"==typeof e[5]&&e[5].length?t.attribs[e[5]]=e[6]:"string"==typeof e[7]&&e[7].length&&(t.attribs[e[7]]=e[7])}},o.prototype.parseTagName=function(t){if(null==t||""==t)return"";var e=o._reTagName.exec(t);return e?(e[1]?"/":"")+e[2]:""},o.prototype.parseTags=function(){for(var t=this._buffer.length-1;o._reTags.test(this._buffer);){this._next=o._reTags.lastIndex-1;var e=this._buffer.charAt(this._next),n=this._buffer.substring(this._current,this._next),r={raw:n,data:this._parseState==i.Text?n:n.replace(o._reTrim,""),type:this._parseState},a=this.parseTagName(r.data);if(this._tagStack.length)if(this._tagStack[this._tagStack.length-1]==i.Script){if("/script"==a.toLowerCase())this._tagStack.pop();else if(0!=r.raw.indexOf("!--"))if(r.type=i.Text,this._elements.length&&this._elements[this._elements.length-1].type==i.Text)(l=this._elements[this._elements.length-1]).raw=l.data=l.raw+this._prevTagSep+r.raw,r.raw=r.data=""}else if(this._tagStack[this._tagStack.length-1]==i.Style){if("/style"==a.toLowerCase())this._tagStack.pop();else if(0!=r.raw.indexOf("!--"))if(r.type=i.Text,this._elements.length&&this._elements[this._elements.length-1].type==i.Text){var l=this._elements[this._elements.length-1];""!=r.raw?(l.raw=l.data=l.raw+this._prevTagSep+r.raw,r.raw=r.data=""):l.raw=l.data=l.raw+this._prevTagSep}else""!=r.raw&&(r.raw=r.data=r.raw)}else if(this._tagStack[this._tagStack.length-1]==i.Comment){var c=r.raw.length;if("-"==r.raw.charAt(c-2)&&"-"==r.raw.charAt(c-1)&&">"==e)if(this._tagStack.pop(),this._elements.length&&this._elements[this._elements.length-1].type==i.Comment)(l=this._elements[this._elements.length-1]).raw=l.data=(l.raw+r.raw).replace(o._reTrimComment,""),r.raw=r.data="",r.type=i.Text;else r.type=i.Comment;else if(r.type=i.Comment,this._elements.length&&this._elements[this._elements.length-1].type==i.Comment)(l=this._elements[this._elements.length-1]).raw=l.data=l.raw+r.raw+e,r.raw=r.data="",r.type=i.Text;else r.raw=r.data=r.raw+e}if(r.type==i.Tag){r.name=a;var s=a.toLowerCase();if(0==r.raw.indexOf("!--")){r.type=i.Comment,delete r.name;c=r.raw.length;"-"==r.raw.charAt(c-1)&&"-"==r.raw.charAt(c-2)&&">"==e?r.raw=r.data=r.raw.replace(o._reTrimComment,""):(r.raw+=e,this._tagStack.push(i.Comment))}else 0==r.raw.indexOf("!")||0==r.raw.indexOf("?")?r.type=i.Directive:"script"==s?(r.type=i.Script,"/"!=r.data.charAt(r.data.length-1)&&this._tagStack.push(i.Script)):"/script"==s?r.type=i.Script:"style"==s?(r.type=i.Style,"/"!=r.data.charAt(r.data.length-1)&&this._tagStack.push(i.Style)):"/style"==s&&(r.type=i.Style);r.name&&"/"==r.name.charAt(0)&&(r.data=r.name)}""==r.raw&&r.type==i.Text||(this._options.includeLocation&&!r.location&&(r.location=this.getLocation(r.type==i.Tag)),this.parseAttribs(r),this._elements.push(r),r.type!=i.Text&&r.type!=i.Comment&&r.type!=i.Directive&&"/"==r.data.charAt(r.data.length-1)&&this._elements.push({raw:"/"+r.name,data:"/"+r.name,name:"/"+r.name,type:r.type})),this._parseState="<"==e?i.Tag:i.Text,this._current=this._next+1,this._prevTagSep=e}this._options.includeLocation&&(this.getLocation(),this._location.row+=this._location.inBuffer,this._location.inBuffer=0,this._location.charOffset=0),this._buffer=this._current<=t?this._buffer.substring(this._current):"",this._current=0,this.writeHandler()},o.prototype.getLocation=function(t){for(var e,n=this._location,r=this._current-(t?1:0),i=t&&0==n.charOffset&&0==this._current;n.charOffset<r;n.charOffset++)"\n"==(e=this._buffer.charAt(n.charOffset))?(n.inBuffer++,n.col=0):"\r"!=e&&n.col++;return{line:n.row+n.inBuffer+1,col:n.col+(i?0:1)}},o.prototype.validateHandler=function(t){if("object"!=typeof t)throw new Error("Handler is not an object");if("function"!=typeof t.reset)throw new Error("Handler method 'reset' is invalid");if("function"!=typeof t.done)throw new Error("Handler method 'done' is invalid");if("function"!=typeof t.writeTag)throw new Error("Handler method 'writeTag' is invalid");if("function"!=typeof t.writeText)throw new Error("Handler method 'writeText' is invalid");if("function"!=typeof t.writeComment)throw new Error("Handler method 'writeComment' is invalid");if("function"!=typeof t.writeDirective)throw new Error("Handler method 'writeDirective' is invalid")},o.prototype.writeHandler=function(t){if(t=!!t,!this._tagStack.length||t)for(;this._elements.length;){var e=this._elements.shift();switch(e.type){case i.Comment:this._handler.writeComment(e);break;case i.Directive:this._handler.writeDirective(e);break;case i.Text:this._handler.writeText(e);break;default:this._handler.writeTag(e)}}},o.prototype.handleError=function(t){if("function"!=typeof this._handler.error)throw t;this._handler.error(t)},t=a,(r=function(){}).prototype=(n=l).prototype,t.super_=n,t.prototype=new r,t.prototype.constructor=t,a.prototype.done=function(){var t,e={},n=c.getElementsByTagName(function(t){return"rss"==t||"feed"==t},this.dom,!1);if(n.length&&(t=n[0]),t){if("rss"==t.name){e.type="rss",t=t.children[0],e.id="";try{e.title=c.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{e.link=c.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(t){}try{e.description=c.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(t){}try{e.updated=new Date(c.getElementsByTagName("lastBuildDate",t.children,!1)[0].children[0].data)}catch(t){}try{e.author=c.getElementsByTagName("managingEditor",t.children,!1)[0].children[0].data}catch(t){}e.items=[],c.getElementsByTagName("item",t.children).forEach(function(t,n,r){var i={};try{i.id=c.getElementsByTagName("guid",t.children,!1)[0].children[0].data}catch(t){}try{i.title=c.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{i.link=c.getElementsByTagName("link",t.children,!1)[0].children[0].data}catch(t){}try{i.description=c.getElementsByTagName("description",t.children,!1)[0].children[0].data}catch(t){}try{i.pubDate=new Date(c.getElementsByTagName("pubDate",t.children,!1)[0].children[0].data)}catch(t){}e.items.push(i)})}else{e.type="atom";try{e.id=c.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(t){}try{e.title=c.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{e.link=c.getElementsByTagName("link",t.children,!1)[0].attribs.href}catch(t){}try{e.description=c.getElementsByTagName("subtitle",t.children,!1)[0].children[0].data}catch(t){}try{e.updated=new Date(c.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(t){}try{e.author=c.getElementsByTagName("email",t.children,!0)[0].children[0].data}catch(t){}e.items=[],c.getElementsByTagName("entry",t.children).forEach(function(t,n,r){var i={};try{i.id=c.getElementsByTagName("id",t.children,!1)[0].children[0].data}catch(t){}try{i.title=c.getElementsByTagName("title",t.children,!1)[0].children[0].data}catch(t){}try{i.link=c.getElementsByTagName("link",t.children,!1)[0].attribs.href}catch(t){}try{i.description=c.getElementsByTagName("summary",t.children,!1)[0].children[0].data}catch(t){}try{i.pubDate=new Date(c.getElementsByTagName("updated",t.children,!1)[0].children[0].data)}catch(t){}e.items.push(i)})}this.dom=e}a.super_.prototype.done.call(this)},l._emptyTags={area:1,base:1,basefont:1,br:1,col:1,frame:1,hr:1,img:1,input:1,isindex:1,link:1,meta:1,param:1,embed:1},l.reWhitespace=/^\s*$/,l.prototype.dom=null,l.prototype.reset=function(){this.dom=[],this._done=!1,this._tagStack=[],this._tagStack.last=function(){return this.length?this[this.length-1]:null}},l.prototype.done=function(){this._done=!0,this.handleCallback(null)},l.prototype.writeTag=function(t){this.handleElement(t)},l.prototype.writeText=function(t){this._options.ignoreWhitespace&&l.reWhitespace.test(t.data)||this.handleElement(t)},l.prototype.writeComment=function(t){this.handleElement(t)},l.prototype.writeDirective=function(t){this.handleElement(t)},l.prototype.error=function(t){this.handleCallback(t)},l.prototype._options=null,l.prototype._callback=null,l.prototype._done=!1,l.prototype._tagStack=null,l.prototype.handleCallback=function(t){if("function"==typeof this._callback)this._callback(t,this.dom);else if(t)throw t},l.prototype.isEmptyTag=function(t){var e=t.name.toLowerCase();return"/"==e.charAt(0)&&(e=e.substring(1)),this._options.enforceEmptyTags&&!!l._emptyTags[e]},l.prototype.handleElement=function(t){if(this._done&&this.handleCallback(new Error("Writing to the handler after done() called is not allowed without a reset()")),this._options.verbose||(delete t.raw,"tag"!=t.type&&"script"!=t.type&&"style"!=t.type||delete t.data),this._tagStack.last())if(t.type!=i.Text&&t.type!=i.Comment&&t.type!=i.Directive)if("/"==t.name.charAt(0)){var e=t.name.substring(1);if(!this.isEmptyTag(t)){for(var n=this._tagStack.length-1;n>-1&&this._tagStack[n--].name!=e;);if(n>-1||this._tagStack[0].name==e)for(;n<this._tagStack.length-1;)this._tagStack.pop()}}else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(t),this.isEmptyTag(t)||this._tagStack.push(t);else this._tagStack.last().children||(this._tagStack.last().children=[]),this._tagStack.last().children.push(t);else t.type!=i.Text&&t.type!=i.Comment&&t.type!=i.Directive?"/"!=t.name.charAt(0)&&(this.dom.push(t),this.isEmptyTag(t)||this._tagStack.push(t)):this.dom.push(t)};var c={testElement:function(t,e){if(!e)return!1;for(var n in t)if("tag_name"==n){if("tag"!=e.type&&"script"!=e.type&&"style"!=e.type)return!1;if(!t.tag_name(e.name))return!1}else if("tag_type"==n){if(!t.tag_type(e.type))return!1}else if("tag_contains"==n){if("text"!=e.type&&"comment"!=e.type&&"directive"!=e.type)return!1;if(!t.tag_contains(e.data))return!1}else if(!e.attribs||!t[n](e.attribs[n]))return!1;return!0},getElements:function(t,e,n,r){if(n=null==n||!!n,r=isNaN(parseInt(r))?-1:parseInt(r),!e)return[];var i,o=[];function a(t){return function(e){return e==t}}for(var l in t)"function"!=typeof t[l]&&(t[l]=a(t[l]));if(c.testElement(t,e)&&o.push(e),r>=0&&o.length>=r)return o;if(n&&e.children)i=e.children;else{if(!(e instanceof Array))return o;i=e}for(var s=0;s<i.length&&(o=o.concat(c.getElements(t,i[s],n,r)),!(r>=0&&o.length>=r));s++);return o},getElementById:function(t,e,n){var r=c.getElements({id:t},e,n,1);return r.length?r[0]:null},getElementsByTagName:function(t,e,n,r){return c.getElements({tag_name:t},e,n,r)},getElementsByTagType:function(t,e,n,r){return c.getElements({tag_type:t},e,n,r)}};e.Parser=o,e.DefaultHandler=l,e.RssHandler=a,e.ElementType=i,e.DomUtils=c}()}(0,An.exports);var En=Sn(An.exports);function xn(){return"undefined"!=typeof window&&void 0!==window.document}function jn(){let t="undefined"!=typeof self?self:xn()?window:"undefined"!=typeof global?global:null;return En||t.htmlparser||t.Tautologistics.NodeHtmlParser}function kn(t){return"[object Array]"===Object.prototype.toString.call(t)}function On(t){return"[object Object]"===Object.prototype.toString.call(t)}function Nn(t,e){let n=function(){let t,e,n=new Promise(function(){t=arguments[0],e=arguments[1]});return n.resolve=t,n.reject=e,n}();if(!kn(t)&&!On(t))return n.reject("rs is not an array or object"),n;let r=!1;if(On(t)){r=!0;let e=[];te(t,(t,n)=>{e.push({k:n,v:t})}),t=e}vn(e)||(e=function(t){return t});let i=-1,o=[];return t.reduce(function(t,n){return t.then(function(t){o.push(t),i+=1;let a=i,l=n;return r&&(a=n.k,l=n.v),vn(e)?e(l,a):l})},Promise.resolve()).then(function(t){o.push(t),o=Me(o),n.resolve(o)}).catch(function(t){n.reject(t)}),n}function Cn(t){return t!=t}function Dn(t){let e=!1;if(_n(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Cn(t))return!1;e=!0}return e}function Rn(t){if(!Dn(t))return 0;return Le(t)}function zn(t){return!!Dn(t)&&(t=Rn(t),"number"==typeof(e=t)&&e==Ie(e));var e}var Ln=d.isFinite,In=Math.min;var Mn=function(t){var e=Math[t];return function(t,n){if(t=Re(t),(n=null==n?0:In(Ie(n),292))&&Ln(t)){var r=(pt(t)+"e").split("e");return+((r=(pt(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round"),Hn=Mn;function Pn(t){if(!Dn(t))return 0;t=Rn(t);let e=Hn(t);return"0"===String(e)?0:e}function Bn(t){if(!zn(t))return!1;return Pn(t)>=0}function Fn(t,e){if(!_n(t))return"";if(!Bn(e))return"";if(0===(e=Pn(e)))return"";let n=t.length-e;return n<0&&(n=0),t.substring(n,n+e)}function Un(t,e){return _n(t)&&Bn(e)?0===(e=Pn(e))?t:function(t,e){return _n(t)&&Bn(e)?0===(e=Pn(e))?"":t.substring(0,e):""}(t,t.length-e):""}function $n(t){if(!_n(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===Fn(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===Fn(t,1)){let e=Un(t,1);return":"===Fn(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===Fn(t,1)){let e=Un(t,1);return 0===e.length?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}function Wn(t){if(!_n(t))return"";let e=$n(t);if(e.isRoot)return e.path;let n=e.path;try{n=n.split("\\").pop().split("/").pop()}catch(t){}return n}function Gn(t){if(!_n(t))return"";let e=Wn(t),n=ve(e,".");if(gn(n)<=1)return e;let r="";try{n=(l=null==(i=n)?0:i.length)?ee(i,0,(o=l-(o=a||void 0===o?1:Ie(o)))<0?0:o):[],r=ke(n,".")}catch(t){}var i,o,a,l;return r}function qn(t){if(!_n(t))return"";let e=$n(t);if(e.isRoot)return e.path;let n=Wn(t=e.path);if(!_n(n))return t;let r=$n(t=Un(t,n.length));return r.isRoot,r.path}function Yn(t){return function(t,e={}){let n=gt(e,"fs");return!!n.existsSync(t)&&!n.lstatSync(t).isDirectory()&&!n.lstatSync(t).isSymbolicLink()}(t,{fs:e})}function Xn(t){return pt(t).toLowerCase()}function Vn(t){var e=this.__data__=new K(t);this.size=e.size}Vn.prototype.clear=function(){this.__data__=new K,this.size=0},Vn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Vn.prototype.get=function(t){return this.__data__.get(t)},Vn.prototype.has=function(t){return this.__data__.has(t)},Vn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof K){var r=n.__data__;if(!J||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Q(r)}return n.set(t,e),this.size=n.size,this};var Kn=function(){try{var t=U(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Jn=Kn;function Zn(t,e,n){"__proto__"==e&&Jn?Jn(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var Qn=Object.prototype.hasOwnProperty;function tr(t,e,n){var r=t[e];Qn.call(t,e)&&Y(r,n)&&(void 0!==n||e in t)||Zn(t,e,n)}function er(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var l=e[o],c=r?r(n[l],t[l],l,n,t):void 0;void 0===c&&(c=t[l]),i?Zn(n,l,c):tr(n,l,c)}return n}var nr=Object.prototype.hasOwnProperty;function rr(t){if(!k(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=Wt(t),n=[];for(var r in t)("constructor"!=r||!e&&nr.call(t,r))&&n.push(r);return n}function ir(t){return Vt(t)?Ut(t,!0):rr(t)}var or="object"==typeof exports&&exports&&!exports.nodeType&&exports,ar=or&&"object"==typeof module&&module&&!module.nodeType&&module,lr=ar&&ar.exports===or?d.Buffer:void 0,cr=lr?lr.allocUnsafe:void 0;function sr(){return[]}var ur=Object.prototype.propertyIsEnumerable,fr=Object.getOwnPropertySymbols,pr=fr?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}(fr(t),function(e){return ur.call(t,e)}))}:sr,hr=pr;function dr(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var mr=Gt(Object.getPrototypeOf,Object),gr=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)dr(e,hr(t)),t=mr(t);return e}:sr,yr=gr;function br(t,e,n){var r=e(t);return f(t)?r:dr(r,n(t))}function _r(t){return br(t,Kt,hr)}function vr(t){return br(t,ir,yr)}var wr=Object.prototype.hasOwnProperty;var Tr=d.Uint8Array;function Sr(t){var e=new t.constructor(t.byteLength);return new Tr(e).set(new Tr(t)),e}var Ar=/\w*$/;var Er=m?m.prototype:void 0,xr=Er?Er.valueOf:void 0;function jr(t,e,n){var r,i=t.constructor;switch(e){case"[object ArrayBuffer]":return Sr(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return function(t,e){var n=e?Sr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(t,e){var n=e?Sr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,n);case"[object Map]":case"[object Set]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return function(t){var e=new t.constructor(t.source,Ar.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Symbol]":return r=t,xr?Object(xr.call(r)):{}}}var kr=Object.create,Or=function(){function t(){}return function(e){if(!k(e))return{};if(kr)return kr(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),Nr=Or;var Cr=Ht&&Ht.isMap,Dr=Cr?zt(Cr):function(t){return S(t)&&"[object Map]"==Qe(t)};var Rr=Ht&&Ht.isSet,zr=Rr?zt(Rr):function(t){return S(t)&&"[object Set]"==Qe(t)},Lr="[object Arguments]",Ir="[object Function]",Mr="[object Object]",Hr={};function Pr(t,e,n,r,i,o){var a,l=1&e,c=2&e,s=4&e;if(n&&(a=i?n(t,r,i,o):n(t)),void 0!==a)return a;if(!k(t))return t;var u=f(t);if(u){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&wr.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!l)return function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(t,a)}else{var p=Qe(t),h=p==Ir||"[object GeneratorFunction]"==p;if(Ot(t))return function(t,e){if(e)return t.slice();var n=t.length,r=cr?cr(n):new t.constructor(n);return t.copy(r),r}(t,l);if(p==Mr||p==Lr||h&&!i){if(a=c||h?{}:function(t){return"function"!=typeof t.constructor||Wt(t)?{}:Nr(mr(t))}(t),!l)return c?function(t,e){return er(t,yr(t),e)}(t,function(t,e){return t&&er(e,ir(e),t)}(a,t)):function(t,e){return er(t,hr(t),e)}(t,function(t,e){return t&&er(e,Kt(e),t)}(a,t))}else{if(!Hr[p])return i?t:{};a=jr(t,p,l)}}o||(o=new Vn);var d=o.get(t);if(d)return d;o.set(t,a),zr(t)?t.forEach(function(r){a.add(Pr(r,e,n,r,t,o))}):Dr(t)&&t.forEach(function(r,i){a.set(i,Pr(r,e,n,i,t,o))});var m=u?void 0:(s?c?vr:_r:c?ir:Kt)(t);return yt(m||t,function(r,i){m&&(r=t[i=r]),tr(a,i,Pr(r,e,n,i,t,o))}),a}Hr[Lr]=Hr["[object Array]"]=Hr["[object ArrayBuffer]"]=Hr["[object DataView]"]=Hr["[object Boolean]"]=Hr["[object Date]"]=Hr["[object Float32Array]"]=Hr["[object Float64Array]"]=Hr["[object Int8Array]"]=Hr["[object Int16Array]"]=Hr["[object Int32Array]"]=Hr["[object Map]"]=Hr["[object Number]"]=Hr[Mr]=Hr["[object RegExp]"]=Hr["[object Set]"]=Hr["[object String]"]=Hr["[object Symbol]"]=Hr["[object Uint8Array]"]=Hr["[object Uint8ClampedArray]"]=Hr["[object Uint16Array]"]=Hr["[object Uint32Array]"]=!0,Hr["[object Error]"]=Hr[Ir]=Hr["[object WeakMap]"]=!1;function Br(t){return Pr(t,5)}let Fr=(t,e)=>{let n=t.toString("base64"),r=(t=>"png"===(t=Xn(t))?"image/png":"jpg"===t||"jpeg"===t?"image/jpeg":"gif"===t?"image/gif":"svg"===t?"image/svg+xml":"webp"===t?"image/webp":"application/octet-stream")(e);return`data:${r};base64,${n}`},Ur=async(t,r,i={})=>{if(!Yn(t))throw new Error(`fpInp[${t}] does not exist`);let o=gt(i,"funGetWidth"),a=gt(i,"funGetHeight"),l=gt(i,"funGetSize"),c=gt(i,"cropLeft"),s=gt(i,"cropTop"),u=gt(i,"cropWidth"),f=gt(i,"cropHeight"),p=gt(i,"density");Dn(p)||(p=96),p=Pn(p);let h=gt(i,"returnBase64");yn(h)||(h=!1);let d=function(t){if(!_n(t))return"";let e=ve(Wn(t),".");if(gn(e)<=1)return"";let n="";try{n=(i=null==(r=e)?0:r.length)?r[i-1]:void 0}catch(t){}var r,i;return n}(r);d=Xn(d);let m=e.readFileSync(t),g=null,y=null;if(vn(l)||vn(o)||vn(a)){let t=await n(m).metadata();if(vn(l)){let e=l(Br(t));if(wn(e)&&(e=await e),!Dn(gt(e,"width")))throw new Error("invalid ret.width for funGetSize");if(!Dn(gt(e,"height")))throw new Error("invalid ret.height for funGetSize");g=Pn(e.width),y=Pn(e.height)}else vn(o)?(g=o(Br(t)),wn(g)&&(g=await g),g=Pn(g)):vn(a)&&(y=a(Br(t)),wn(y)&&(y=await y),y=Pn(y))}let b=await n(m,{density:p}),_=Dn(g),v=Dn(y),w=Dn(c)&&Dn(s)&&Dn(u)&&Dn(f);_&&v?b=b.resize({width:g,height:y,withoutEnlargement:!0}):_&&!v?b=b.resize({width:g,withoutEnlargement:!0}):!_&&v&&(b=b.resize({height:y,withoutEnlargement:!0})),w&&(c=Pn(c),s=Pn(s),u=Pn(u),f=Pn(f),b=b.extract({left:c,top:s,width:u,height:f}));let T={png:()=>b.png({compressionLevel:9,adaptiveFiltering:!1,palette:!1,quality:100,colors:256,...i}),jpg:()=>b.flatten({background:gt(i,"background","#fff")}).jpeg({quality:100,progressive:!1,chromaSubsampling:"4:2:0",optimiseCoding:!0,mozjpeg:!1,overshootDeringing:!1,...i}),jpeg:()=>b.flatten({background:gt(i,"background","#fff")}).jpeg({quality:100,progressive:!1,chromaSubsampling:"4:2:0",optimiseCoding:!0,mozjpeg:!1,overshootDeringing:!1,...i}),webp:()=>b.webp({quality:100,alphaQuality:100,lossless:!0,...i}),avif:()=>b.avif({quality:50,lossless:!1,speed:5,chromaSubsampling:"4:2:0",...i}),gif:()=>b.gif({effort:7,interlace:!1,...i}),tiff:()=>b.tiff({quality:100,compression:"jpeg",predictor:"horizontal",pyramid:!1,tile:!1,...i}),bmp:()=>b.bmp({...i})};var S,A;A=d,b=On(S=T)&&(_n(A)||Dn(A))&&A in S?T[d]():b.toFormat(d);let E=await b.toBuffer();if(h){return Fr(E,d)}return e.writeFileSync(r,E),"ok"},$r=async(t,e,n={})=>{let r={...n,cropLeft:null,cropTop:null,cropWidth:null,cropHeight:null,returnBase64:!0};return await Ur(t,`${t}.${e}`,r)};function Wr(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Q;++e<n;)this.add(t[e])}function Gr(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function qr(t,e){return t.has(e)}Wr.prototype.add=Wr.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Wr.prototype.has=function(t){return this.__data__.has(t)};function Yr(t,e,n,r,i,o){var a=1&n,l=t.length,c=e.length;if(l!=c&&!(a&&c>l))return!1;var s=o.get(t),u=o.get(e);if(s&&u)return s==e&&u==t;var f=-1,p=!0,h=2&n?new Wr:void 0;for(o.set(t,e),o.set(e,t);++f<l;){var d=t[f],m=e[f];if(r)var g=a?r(m,d,f,e,t,o):r(d,m,f,t,e,o);if(void 0!==g){if(g)continue;p=!1;break}if(h){if(!Gr(e,function(t,e){if(!qr(h,e)&&(d===t||i(d,t,n,r,o)))return h.push(e)})){p=!1;break}}else if(d!==m&&!i(d,m,n,r,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function Xr(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function Vr(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var Kr=m?m.prototype:void 0,Jr=Kr?Kr.valueOf:void 0;var Zr=Object.prototype.hasOwnProperty;var Qr="[object Arguments]",ti="[object Array]",ei="[object Object]",ni=Object.prototype.hasOwnProperty;function ri(t,e,n,r,i,o){var a=f(t),l=f(e),c=a?ti:Qe(t),s=l?ti:Qe(e),u=(c=c==Qr?ei:c)==ei,p=(s=s==Qr?ei:s)==ei,h=c==s;if(h&&Ot(t)){if(!Ot(e))return!1;a=!0,u=!1}if(h&&!u)return o||(o=new Vn),a||Bt(t)?Yr(t,e,n,r,i,o):function(t,e,n,r,i,o,a){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!o(new Tr(t),new Tr(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Y(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var l=Xr;case"[object Set]":var c=1&r;if(l||(l=Vr),t.size!=e.size&&!c)return!1;var s=a.get(t);if(s)return s==e;r|=2,a.set(t,e);var u=Yr(l(t),l(e),r,i,o,a);return a.delete(t),u;case"[object Symbol]":if(Jr)return Jr.call(t)==Jr.call(e)}return!1}(t,e,c,n,r,i,o);if(!(1&n)){var d=u&&ni.call(t,"__wrapped__"),m=p&&ni.call(e,"__wrapped__");if(d||m){var g=d?t.value():t,y=m?e.value():e;return o||(o=new Vn),i(g,y,n,r,o)}}return!!h&&(o||(o=new Vn),function(t,e,n,r,i,o){var a=1&n,l=_r(t),c=l.length;if(c!=_r(e).length&&!a)return!1;for(var s=c;s--;){var u=l[s];if(!(a?u in e:Zr.call(e,u)))return!1}var f=o.get(t),p=o.get(e);if(f&&p)return f==e&&p==t;var h=!0;o.set(t,e),o.set(e,t);for(var d=a;++s<c;){var m=t[u=l[s]],g=e[u];if(r)var y=a?r(g,m,u,e,t,o):r(m,g,u,t,e,o);if(!(void 0===y?m===g||i(m,g,n,r,o):y)){h=!1;break}d||(d="constructor"==u)}if(h&&!d){var b=t.constructor,_=e.constructor;b==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _||(h=!1)}return o.delete(t),o.delete(e),h}(t,e,n,r,i,o))}function ii(t,e,n,r,i){return t===e||(null==t||null==e||!S(t)&&!S(e)?t!=t&&e!=e:ri(t,e,n,r,ii,i))}function oi(t){return t==t&&!k(t)}function ai(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}function li(t){var e=function(t){for(var e=Kt(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,oi(i)]}return e}(t);return 1==e.length&&e[0][2]?ai(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=Object(t);i--;){var l=n[i];if(a&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++i<o;){var c=(l=n[i])[0],s=t[c],u=l[1];if(a&&l[2]){if(void 0===s&&!(c in t))return!1}else{var f=new Vn;if(r)var p=r(s,u,c,t,e,f);if(!(void 0===p?ii(u,s,3,r,f):p))return!1}}return!0}(n,t,e)}}function ci(t,e){return null!=t&&e in Object(t)}function si(t,e){return null!=t&&function(t,e,n){for(var r=-1,i=(e=ht(e,t)).length,o=!1;++r<i;){var a=dt(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&Dt(i)&&Ct(a,i)&&(f(t)||Et(t))}(t,e,ci)}function ui(t){return j(t)?tn(dt(t)):function(t){return function(e){return mt(e,t)}}(t)}function fi(t){return"function"==typeof t?t:null==t?Qt:"object"==typeof t?f(t)?function(t,e){return j(t)&&oi(e)?ai(dt(t),e):function(n){var r=gt(n,t);return void 0===r&&r===e?si(n,t):ii(e,r,3)}}(t[0],t[1]):li(t):ui(t)}function pi(t,e){var n=-1,r=Vt(t)?Array(t.length):[];return Zt(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function hi(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(On(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!bn(t)||""!==t)}(t)||(!!function(t){return!!kn(t)&&0===t.length}(t)||!!Cn(t)))))}
/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */
const{entries:di,setPrototypeOf:mi,isFrozen:gi,getPrototypeOf:yi,getOwnPropertyDescriptor:bi}=Object;let{freeze:_i,seal:vi,create:wi}=Object,{apply:Ti,construct:Si}="undefined"!=typeof Reflect&&Reflect;_i||(_i=function(t){return t}),vi||(vi=function(t){return t}),Ti||(Ti=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return t.apply(e,r)}),Si||(Si=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return new t(...n)});const Ai=Pi(Array.prototype.forEach),Ei=Pi(Array.prototype.lastIndexOf),xi=Pi(Array.prototype.pop),ji=Pi(Array.prototype.push),ki=Pi(Array.prototype.splice),Oi=Pi(String.prototype.toLowerCase),Ni=Pi(String.prototype.toString),Ci=Pi(String.prototype.match),Di=Pi(String.prototype.replace),Ri=Pi(String.prototype.indexOf),zi=Pi(String.prototype.trim),Li=Pi(Object.prototype.hasOwnProperty),Ii=Pi(RegExp.prototype.test),Mi=(Hi=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Si(Hi,e)});var Hi;function Pi(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Ti(t,e,r)}}function Bi(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Oi;mi&&mi(t,null);let r=e.length;for(;r--;){let i=e[r];if("string"==typeof i){const t=n(i);t!==i&&(gi(e)||(e[r]=t),i=t)}t[i]=!0}return t}function Fi(t){for(let e=0;e<t.length;e++){Li(t,e)||(t[e]=null)}return t}function Ui(t){const e=wi(null);for(const[n,r]of di(t)){Li(t,n)&&(Array.isArray(r)?e[n]=Fi(r):r&&"object"==typeof r&&r.constructor===Object?e[n]=Ui(r):e[n]=r)}return e}function $i(t,e){for(;null!==t;){const n=bi(t,e);if(n){if(n.get)return Pi(n.get);if("function"==typeof n.value)return Pi(n.value)}t=yi(t)}return function(){return null}}const Wi=_i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Gi=_i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),qi=_i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Yi=_i(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xi=_i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Vi=_i(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ki=_i(["#text"]),Ji=_i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Zi=_i(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Qi=_i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),to=_i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),eo=vi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),no=vi(/<%[\w\W]*|[\w\W]*%>/gm),ro=vi(/\$\{[\w\W]*/gm),io=vi(/^data-[\-\w.\u00B7-\uFFFF]+$/),oo=vi(/^aria-[\-\w]+$/),ao=vi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),lo=vi(/^(?:\w+script|data):/i),co=vi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),so=vi(/^html$/i),uo=vi(/^[a-z][.\w]*(-[.\w]+)+$/i);var fo=Object.freeze({__proto__:null,ARIA_ATTR:oo,ATTR_WHITESPACE:co,CUSTOM_ELEMENT:uo,DATA_ATTR:io,DOCTYPE_NAME:so,ERB_EXPR:no,IS_ALLOWED_URI:ao,IS_SCRIPT_OR_DATA:lo,MUSTACHE_EXPR:eo,TMPLIT_EXPR:ro});const po=1,ho=3,mo=7,go=8,yo=9,bo=function(){return"undefined"==typeof window?null:window};var _o=function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bo();const n=e=>t(e);if(n.version="3.3.1",n.removed=[],!e||!e.document||e.document.nodeType!==yo||!e.Element)return n.isSupported=!1,n;let{document:r}=e;const i=r,o=i.currentScript,{DocumentFragment:a,HTMLTemplateElement:l,Node:c,Element:s,NodeFilter:u,NamedNodeMap:f=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:p,DOMParser:h,trustedTypes:d}=e,m=s.prototype,g=$i(m,"cloneNode"),y=$i(m,"remove"),b=$i(m,"nextSibling"),_=$i(m,"childNodes"),v=$i(m,"parentNode");if("function"==typeof l){const t=r.createElement("template");t.content&&t.content.ownerDocument&&(r=t.content.ownerDocument)}let w,T="";const{implementation:S,createNodeIterator:A,createDocumentFragment:E,getElementsByTagName:x}=r,{importNode:j}=i;let k={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof di&&"function"==typeof v&&S&&void 0!==S.createHTMLDocument;const{MUSTACHE_EXPR:O,ERB_EXPR:N,TMPLIT_EXPR:C,DATA_ATTR:D,ARIA_ATTR:R,IS_SCRIPT_OR_DATA:z,ATTR_WHITESPACE:L,CUSTOM_ELEMENT:I}=fo;let{IS_ALLOWED_URI:M}=fo,H=null;const P=Bi({},[...Wi,...Gi,...qi,...Xi,...Ki]);let B=null;const F=Bi({},[...Ji,...Zi,...Qi,...to]);let U=Object.seal(wi(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),$=null,W=null;const G=Object.seal(wi(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let q=!0,Y=!0,X=!1,V=!0,K=!1,J=!0,Z=!1,Q=!1,tt=!1,et=!1,nt=!1,rt=!1,it=!0,ot=!1,at=!0,lt=!1,ct={},st=null;const ut=Bi({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ft=null;const pt=Bi({},["audio","video","img","source","image","track"]);let ht=null;const dt=Bi({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),mt="http://www.w3.org/1998/Math/MathML",gt="http://www.w3.org/2000/svg",yt="http://www.w3.org/1999/xhtml";let bt=yt,_t=!1,vt=null;const wt=Bi({},[mt,gt,yt],Ni);let Tt=Bi({},["mi","mo","mn","ms","mtext"]),St=Bi({},["annotation-xml"]);const At=Bi({},["title","style","font","a","script"]);let Et=null;const xt=["application/xhtml+xml","text/html"];let jt=null,kt=null;const Ot=r.createElement("form"),Nt=function(t){return t instanceof RegExp||t instanceof Function},Ct=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!kt||kt!==t){if(t&&"object"==typeof t||(t={}),t=Ui(t),Et=-1===xt.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,jt="application/xhtml+xml"===Et?Ni:Oi,H=Li(t,"ALLOWED_TAGS")?Bi({},t.ALLOWED_TAGS,jt):P,B=Li(t,"ALLOWED_ATTR")?Bi({},t.ALLOWED_ATTR,jt):F,vt=Li(t,"ALLOWED_NAMESPACES")?Bi({},t.ALLOWED_NAMESPACES,Ni):wt,ht=Li(t,"ADD_URI_SAFE_ATTR")?Bi(Ui(dt),t.ADD_URI_SAFE_ATTR,jt):dt,ft=Li(t,"ADD_DATA_URI_TAGS")?Bi(Ui(pt),t.ADD_DATA_URI_TAGS,jt):pt,st=Li(t,"FORBID_CONTENTS")?Bi({},t.FORBID_CONTENTS,jt):ut,$=Li(t,"FORBID_TAGS")?Bi({},t.FORBID_TAGS,jt):Ui({}),W=Li(t,"FORBID_ATTR")?Bi({},t.FORBID_ATTR,jt):Ui({}),ct=!!Li(t,"USE_PROFILES")&&t.USE_PROFILES,q=!1!==t.ALLOW_ARIA_ATTR,Y=!1!==t.ALLOW_DATA_ATTR,X=t.ALLOW_UNKNOWN_PROTOCOLS||!1,V=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,K=t.SAFE_FOR_TEMPLATES||!1,J=!1!==t.SAFE_FOR_XML,Z=t.WHOLE_DOCUMENT||!1,et=t.RETURN_DOM||!1,nt=t.RETURN_DOM_FRAGMENT||!1,rt=t.RETURN_TRUSTED_TYPE||!1,tt=t.FORCE_BODY||!1,it=!1!==t.SANITIZE_DOM,ot=t.SANITIZE_NAMED_PROPS||!1,at=!1!==t.KEEP_CONTENT,lt=t.IN_PLACE||!1,M=t.ALLOWED_URI_REGEXP||ao,bt=t.NAMESPACE||yt,Tt=t.MATHML_TEXT_INTEGRATION_POINTS||Tt,St=t.HTML_INTEGRATION_POINTS||St,U=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&Nt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&Nt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(U.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),K&&(Y=!1),nt&&(et=!0),ct&&(H=Bi({},Ki),B=[],!0===ct.html&&(Bi(H,Wi),Bi(B,Ji)),!0===ct.svg&&(Bi(H,Gi),Bi(B,Zi),Bi(B,to)),!0===ct.svgFilters&&(Bi(H,qi),Bi(B,Zi),Bi(B,to)),!0===ct.mathMl&&(Bi(H,Xi),Bi(B,Qi),Bi(B,to))),t.ADD_TAGS&&("function"==typeof t.ADD_TAGS?G.tagCheck=t.ADD_TAGS:(H===P&&(H=Ui(H)),Bi(H,t.ADD_TAGS,jt))),t.ADD_ATTR&&("function"==typeof t.ADD_ATTR?G.attributeCheck=t.ADD_ATTR:(B===F&&(B=Ui(B)),Bi(B,t.ADD_ATTR,jt))),t.ADD_URI_SAFE_ATTR&&Bi(ht,t.ADD_URI_SAFE_ATTR,jt),t.FORBID_CONTENTS&&(st===ut&&(st=Ui(st)),Bi(st,t.FORBID_CONTENTS,jt)),t.ADD_FORBID_CONTENTS&&(st===ut&&(st=Ui(st)),Bi(st,t.ADD_FORBID_CONTENTS,jt)),at&&(H["#text"]=!0),Z&&Bi(H,["html","head","body"]),H.table&&(Bi(H,["tbody"]),delete $.tbody),t.TRUSTED_TYPES_POLICY){if("function"!=typeof t.TRUSTED_TYPES_POLICY.createHTML)throw Mi('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof t.TRUSTED_TYPES_POLICY.createScriptURL)throw Mi('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=t.TRUSTED_TYPES_POLICY,T=w.createHTML("")}else void 0===w&&(w=function(t,e){if("object"!=typeof t||"function"!=typeof t.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";e&&e.hasAttribute(r)&&(n=e.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:t=>t,createScriptURL:t=>t})}catch(t){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(d,o)),null!==w&&"string"==typeof T&&(T=w.createHTML(""));_i&&_i(t),kt=t}},Dt=Bi({},[...Gi,...qi,...Yi]),Rt=Bi({},[...Xi,...Vi]),zt=function(t){ji(n.removed,{element:t});try{v(t).removeChild(t)}catch(e){y(t)}},Lt=function(t,e){try{ji(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){ji(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t)if(et||nt)try{zt(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},It=function(t){let e=null,n=null;if(tt)t="<remove></remove>"+t;else{const e=Ci(t,/^[\r\n\t ]+/);n=e&&e[0]}"application/xhtml+xml"===Et&&bt===yt&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const i=w?w.createHTML(t):t;if(bt===yt)try{e=(new h).parseFromString(i,Et)}catch(t){}if(!e||!e.documentElement){e=S.createDocument(bt,"template",null);try{e.documentElement.innerHTML=_t?T:i}catch(t){}}const o=e.body||e.documentElement;return t&&n&&o.insertBefore(r.createTextNode(n),o.childNodes[0]||null),bt===yt?x.call(e,Z?"html":"body")[0]:Z?e.documentElement:o},Mt=function(t){return A.call(t.ownerDocument||t,t,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Ht=function(t){return t instanceof p&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof f)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},Pt=function(t){return"function"==typeof c&&t instanceof c};function Bt(t,e,r){Ai(t,t=>{t.call(n,e,r,kt)})}const Ft=function(t){let e=null;if(Bt(k.beforeSanitizeElements,t,null),Ht(t))return zt(t),!0;const r=jt(t.nodeName);if(Bt(k.uponSanitizeElement,t,{tagName:r,allowedTags:H}),J&&t.hasChildNodes()&&!Pt(t.firstElementChild)&&Ii(/<[/\w!]/g,t.innerHTML)&&Ii(/<[/\w!]/g,t.textContent))return zt(t),!0;if(t.nodeType===mo)return zt(t),!0;if(J&&t.nodeType===go&&Ii(/<[/\w]/g,t.data))return zt(t),!0;if(!(G.tagCheck instanceof Function&&G.tagCheck(r))&&(!H[r]||$[r])){if(!$[r]&&$t(r)){if(U.tagNameCheck instanceof RegExp&&Ii(U.tagNameCheck,r))return!1;if(U.tagNameCheck instanceof Function&&U.tagNameCheck(r))return!1}if(at&&!st[r]){const e=v(t)||t.parentNode,n=_(t)||t.childNodes;if(n&&e){for(let r=n.length-1;r>=0;--r){const i=g(n[r],!0);i.__removalCount=(t.__removalCount||0)+1,e.insertBefore(i,b(t))}}}return zt(t),!0}return t instanceof s&&!function(t){let e=v(t);e&&e.tagName||(e={namespaceURI:bt,tagName:"template"});const n=Oi(t.tagName),r=Oi(e.tagName);return!!vt[t.namespaceURI]&&(t.namespaceURI===gt?e.namespaceURI===yt?"svg"===n:e.namespaceURI===mt?"svg"===n&&("annotation-xml"===r||Tt[r]):Boolean(Dt[n]):t.namespaceURI===mt?e.namespaceURI===yt?"math"===n:e.namespaceURI===gt?"math"===n&&St[r]:Boolean(Rt[n]):t.namespaceURI===yt?!(e.namespaceURI===gt&&!St[r])&&!(e.namespaceURI===mt&&!Tt[r])&&!Rt[n]&&(At[n]||!Dt[n]):!("application/xhtml+xml"!==Et||!vt[t.namespaceURI]))}(t)?(zt(t),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!Ii(/<\/no(script|embed|frames)/i,t.innerHTML)?(K&&t.nodeType===ho&&(e=t.textContent,Ai([O,N,C],t=>{e=Di(e,t," ")}),t.textContent!==e&&(ji(n.removed,{element:t.cloneNode()}),t.textContent=e)),Bt(k.afterSanitizeElements,t,null),!1):(zt(t),!0)},Ut=function(t,e,n){if(it&&("id"===e||"name"===e)&&(n in r||n in Ot))return!1;if(Y&&!W[e]&&Ii(D,e));else if(q&&Ii(R,e));else if(G.attributeCheck instanceof Function&&G.attributeCheck(e,t));else if(!B[e]||W[e]){if(!($t(t)&&(U.tagNameCheck instanceof RegExp&&Ii(U.tagNameCheck,t)||U.tagNameCheck instanceof Function&&U.tagNameCheck(t))&&(U.attributeNameCheck instanceof RegExp&&Ii(U.attributeNameCheck,e)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(e,t))||"is"===e&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&Ii(U.tagNameCheck,n)||U.tagNameCheck instanceof Function&&U.tagNameCheck(n))))return!1}else if(ht[e]);else if(Ii(M,Di(n,L,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==Ri(n,"data:")||!ft[t]){if(X&&!Ii(z,Di(n,L,"")));else if(n)return!1}else;return!0},$t=function(t){return"annotation-xml"!==t&&Ci(t,I)},Wt=function(t){Bt(k.beforeSanitizeAttributes,t,null);const{attributes:e}=t;if(!e||Ht(t))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:B,forceKeepAttr:void 0};let i=e.length;for(;i--;){const o=e[i],{name:a,namespaceURI:l,value:c}=o,s=jt(a),u=c;let f="value"===a?u:zi(u);if(r.attrName=s,r.attrValue=f,r.keepAttr=!0,r.forceKeepAttr=void 0,Bt(k.uponSanitizeAttribute,t,r),f=r.attrValue,!ot||"id"!==s&&"name"!==s||(Lt(a,t),f="user-content-"+f),J&&Ii(/((--!?|])>)|<\/(style|title|textarea)/i,f)){Lt(a,t);continue}if("attributename"===s&&Ci(f,"href")){Lt(a,t);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr){Lt(a,t);continue}if(!V&&Ii(/\/>/i,f)){Lt(a,t);continue}K&&Ai([O,N,C],t=>{f=Di(f,t," ")});const p=jt(t.nodeName);if(Ut(p,s,f)){if(w&&"object"==typeof d&&"function"==typeof d.getAttributeType)if(l);else switch(d.getAttributeType(p,s)){case"TrustedHTML":f=w.createHTML(f);break;case"TrustedScriptURL":f=w.createScriptURL(f)}if(f!==u)try{l?t.setAttributeNS(l,a,f):t.setAttribute(a,f),Ht(t)?zt(t):xi(n.removed)}catch(e){Lt(a,t)}}else Lt(a,t)}Bt(k.afterSanitizeAttributes,t,null)},Gt=function t(e){let n=null;const r=Mt(e);for(Bt(k.beforeSanitizeShadowDOM,e,null);n=r.nextNode();)Bt(k.uponSanitizeShadowNode,n,null),Ft(n),Wt(n),n.content instanceof a&&t(n.content);Bt(k.afterSanitizeShadowDOM,e,null)};return n.sanitize=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,o=null,l=null,s=null;if(_t=!t,_t&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Pt(t)){if("function"!=typeof t.toString)throw Mi("toString is not a function");if("string"!=typeof(t=t.toString()))throw Mi("dirty is not a string, aborting")}if(!n.isSupported)return t;if(Q||Ct(e),n.removed=[],"string"==typeof t&&(lt=!1),lt){if(t.nodeName){const e=jt(t.nodeName);if(!H[e]||$[e])throw Mi("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof c)r=It("\x3c!----\x3e"),o=r.ownerDocument.importNode(t,!0),o.nodeType===po&&"BODY"===o.nodeName||"HTML"===o.nodeName?r=o:r.appendChild(o);else{if(!et&&!K&&!Z&&-1===t.indexOf("<"))return w&&rt?w.createHTML(t):t;if(r=It(t),!r)return et?null:rt?T:""}r&&tt&&zt(r.firstChild);const u=Mt(lt?t:r);for(;l=u.nextNode();)Ft(l),Wt(l),l.content instanceof a&&Gt(l.content);if(lt)return t;if(et){if(nt)for(s=E.call(r.ownerDocument);r.firstChild;)s.appendChild(r.firstChild);else s=r;return(B.shadowroot||B.shadowrootmode)&&(s=j.call(i,s,!0)),s}let f=Z?r.outerHTML:r.innerHTML;return Z&&H["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&Ii(so,r.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+f),K&&Ai([O,N,C],t=>{f=Di(f,t," ")}),w&&rt?w.createHTML(f):f},n.setConfig=function(){Ct(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Q=!0},n.clearConfig=function(){kt=null,Q=!1},n.isValidAttribute=function(t,e,n){kt||Ct({});const r=jt(t),i=jt(e);return Ut(r,i,n)},n.addHook=function(t,e){"function"==typeof e&&ji(k[t],e)},n.removeHook=function(t,e){if(void 0!==e){const n=Ei(k[t],e);return-1===n?void 0:ki(k[t],n,1)[0]}return xi(k[t])},n.removeHooks=function(t){k[t]=[]},n.removeAllHooks=function(){k={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();async function vo(t,e={}){let n=gt(e,"tableBorderColor","");_n(n)||(n="#666");let c=gt(e,"fontFamilies",[]);var s,u,p;(!kn(s=c)||0===s.length||1===s.length&&hi(s[0]))&&(c=["Microsoft JhengHei","Avenir","Helvetica","Arial","sans-serif"]),c=ke((p=t=>`'${t}'`,(f(u=c)?ct:pi)(u,fi(p))),", ");let h=gt(e,"fontSizeUnit","");_n(h)||(h="pt");let d=gt(e,"fontSizeScale","");Dn(d)||(d=1),d=Rn(d);let m=gt(e,"fontSizeDef","");_n(m)||(m=12*d+h);let g=gt(e,"fontSizeH1","");_n(g)||(g=20*d+h);let y=gt(e,"fontSizeH2","");_n(y)||(y=16*d+h);let b=gt(e,"fontSizeH3","");_n(b)||(b=14*d+h);let _=gt(e,"fontSizeH4","");_n(_)||(_=12*d+h);let v=gt(e,"fontSizeH5","");_n(v)||(v=12*d+h);let w=gt(e,"fontSizeH6","");_n(w)||(w=12*d+h);let T=gt(e,"fontSizeP","");_n(T)||(T=12*d+h);let S=gt(e,"fontSizeTab","");_n(S)||(S=11*d+h);let A=gt(e,"fontSizeCode","");_n(A)||(A=10*d+h);let E=gt(e,"textAlignH1","");_n(E)||(E="left");let x=gt(e,"textAlignH2","");_n(x)||(x="left");let j=gt(e,"textAlignH3","");_n(j)||(j="left");let k=gt(e,"textAlignH4","");_n(k)||(k="left");let O=gt(e,"textAlignH5","");_n(O)||(O="left");let N=gt(e,"textAlignH6","");_n(N)||(N="left");let C=gt(e,"imgWidthMax",null);Dn(C)&&(C=`${C}px`),_n(C)||(C="");let D=gt(e,"funWalkTokens",null),R=gt(e,"mergeStyle",null);yn(R)||(R=!1);let z=new r.Marked;z.use(i({throwOnError:!1,nonStandard:!0})),z.use(o()),z.use(l.markedHighlight({langPrefix:"hljs language-",emptyLangClass:"hljs",highlight(t,e){let n=e&&a.getLanguage(e)?e:"plaintext";return a.highlight(t,{language:n}).value}}));let L={image:({href:t,title:e,text:n})=>{let r=_n(e)?`title="${e}"`:"",i="";return _n(C)&&(i=`max-width:${C}; height:auto;`),`<img src="${t}" alt="${n}" ${r} style="${i}">`}},I={async:!0,renderer:L};vn(D)&&(I.walkTokens=D),z.use(I);let M=await z.parse(t);M=`\n        <div class="md" style="contain:layout;">\n            ${M}\n        </div>\n    `;let H=["https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css","https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css"],P='\n\n.md {\n    font-family: {fontFamilies};\n    font-size: {fontSizeDef};\n}\n\n.md table {\n    border-collapse: collapse;\n    margin: 0;\n    padding: 0;\n    word-break: initial;\n    font-family: {fontFamilies};\n    font-size: {fontSizeTab};\n}\n\n.md tr {\n    margin: 0;\n    padding: 0;\n}\n\n.md table tr th {\n    font-weight: bold;\n    background: #eee;\n    border: 1px solid {tableBorderColor};\n    border-bottom: 0;\n    margin: 0;\n    padding: 6px 13px;\n}\n\n.md table tr td {\n    border: 1px solid {tableBorderColor};\n    margin: 0;\n    padding: 6px 13px;\n}\n\n.md h1 {\n    display: block;\n    font-size: {fontSizeH1};\n    margin: 1rem 0;\n    padding: 0;\n    font-weight: bold;\n    text-align: {textAlignH1};\n}\n\n.md h2 {\n    display: block;\n    font-size: {fontSizeH2};\n    margin: 1rem 0;\n    padding: 0;\n    font-weight: bold;\n    text-align: {textAlignH2};\n}\n\n.md h3 {\n    display: block;\n    font-size: {fontSizeH3};\n    margin: 1rem 0;\n    padding: 0;\n    font-weight: bold;\n    text-align: {textAlignH3};\n}\n\n.md h4 {\n    display: block;\n    font-size: {fontSizeH4};\n    margin: 1rem 0;\n    padding: 0;\n    font-weight: bold;\n    text-align: {textAlignH4};\n}\n\n.md h5 {\n    display: block;\n    font-size: {fontSizeH5};\n    margin: 1rem 0;\n    padding: 0;\n    font-weight: bold;\n    text-align: {textAlignH5};\n}\n\n.md h6 {\n    display: block;\n    font-size: {fontSizeH6};\n    margin: 1rem 0;\n    padding: 0;\n    font-weight: bold;\n    text-align: {textAlignH6};\n}\n\n.md p {\n    display: block;\n    font-size: {fontSizeP};\n    margin: 1rem 0;\n    padding: 0;\n} \n\n.md ol {\n    display: block;\n    list-style-type: decimal;\n    margin: 1rem 0;\n    padding: 0;\n    padding-inline-start: 40px;\n} \n\n.md li {\n    display: list-item;\n    /* margin: 0.4rem 0; */ /* styledocx */\n    padding: 0;\n}\n\n.md blockquote {\n    font-style: italic;\n    border-left: 5px solid #debc76;\n    background: #f9f2e3;\n    margin: 1rem 0;\n    padding: 0.1rem 1.0rem 0.1rem 1.0rem;\n}\n\n.md pre {\n    display: block;\n    font-size: {fontSizeCode};\n    overflow: auto;\n    background: #eee;\n    margin: 1rem 0;\n    padding: 0;\n}\n.md pre code.hljs {\n    background: transparent !important;\n    line-height: 1.6 !important;\n}\n\n.md code {\n    font-family: Consolas, "Courier New", monospace;\n}\n\n.md a {\n    color: #0066cc;\n    cursor: pointer;\n}\n\n.md a[data-footnote-ref]::before {\n    content: "[";\n}\n.md a[data-footnote-ref]::after {\n    content: "]";\n}\n.md sup:has(a[data-footnote-ref]) {\n    position: relative;\n    vertical-align: baseline; /*  */\n    top: -0.5em;              /*  */\n    line-height: 0;           /*  */\n}\n\n.md hr {\n    margin: 2rem 0;\n    padding: 0;\n}\n\n.md section {\n    margin: 0;\n    padding: 0;\n}\n\n    ';P=Tn(P,"{fontFamilies}",c),P=Tn(P,"{fontSizeDef}",m),P=Tn(P,"{fontSizeH1}",g),P=Tn(P,"{fontSizeH2}",y),P=Tn(P,"{fontSizeH3}",b),P=Tn(P,"{fontSizeH4}",_),P=Tn(P,"{fontSizeH5}",v),P=Tn(P,"{fontSizeH6}",w),P=Tn(P,"{fontSizeP}",T),P=Tn(P,"{fontSizeTab}",S),P=Tn(P,"{fontSizeCode}",A),P=Tn(P,"{textAlignH1}",E),P=Tn(P,"{textAlignH2}",x),P=Tn(P,"{textAlignH3}",j),P=Tn(P,"{textAlignH4}",k),P=Tn(P,"{textAlignH5}",O),P=Tn(P,"{textAlignH6}",N),P=Tn(P,"{tableBorderColor}",n);let B=null;if(xn())B=_o;else{let t="jsdom",{JSDOM:e}=await import(t),{window:n}=new e("");B=_o(n)}M=B.sanitize(M);let F={};if(R){let t="\n";te(H,e=>{t+=`<link rel="stylesheet" href="${e}">\n`}),t+=`<style>${P}</style>\n`,t+=M,F={html:t,styleSrcs:[],styleDef:""}}else F={html:M,styleSrcs:H,styleDef:P};return F}return async function(n,r,i={}){if(!Yn(n))return Promise.reject(`fpIn[${n}] does not exist`);let o=qn(n=t.resolve(n)),a=gt(i,"htmlTemp",null);_n(a)||(a='\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset="utf-8" />\n    <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n    <meta http-equiv="Cache-Control" content="no-siteapp"/>\n    <meta name="renderer" content="webkit" />\n    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />\n    <title>{title}</title>\n</head>\n<body style="padding:20px; margin:0; overflow-y:auto;">\n    {html}\n</body>\n</html>\n');let l=gt(i,"imgConvertToBase64",null);yn(l)||(l=!0);let c=gt(i,"funProcFpOut"),s=(t,e)=>{let n=ve(t,"\n"),r=0,i=[],o={};te(n,t=>{let n=t;if(t.indexOf(`${e}n`)>=0){r++;let i=`${e}${r}`;n=Tn(t,`${e}n`,i);let a=t;a=function(t){let e=null;if(!_n(t))return"";let n=jn(),r=new n.DefaultHandler(function(t,n){t&&(e=t)});if(new n.Parser(r).parseComplete(t),null!==e)return e;let i=[];return function t(e){te(e,e=>{gn(e.children)>0&&t(e.children),"text"===e.type&&i.push(e.data)})}(r.dom),i=ke(i,""),i}(a),a=Tn(a,`${e}n`,""),a=xe(a),a=`{${a}}`,o[a]=i}i.push(n)});let a=ke(i,"\n");return te(o,(t,e)=>{a=a.replaceAll(e,t)}),a},f=Gn(n),p=qn(n),h=e.readFileSync(n,"utf8"),d=(t=>{let e=ve(t,"\n"),n="";return te(e,(t,r)=>{if(t.indexOf(" pretitle ")>=0)return n=gt(e,r+1,""),n=xe(n),!1}),n})(h);h=s(h,""),h=s(h,""),h=await(async(t,e)=>{let n=[],r=ve(e,"\n");return await Nn(r,async e=>{e.indexOf('src="')>=0&&(e=await(async e=>{let n=ve(e,'src="');if(2!==gn(n))throw new Error("size(s)!==2");let r=n[0],i=ve(n[1],'"'),o=i[0],a="";if(Yn(o))a=o;else if(a=`${t}/${o}`,!Yn(a))throw console.log("c",e),console.log("fnp",o),new Error(`fp[${a}] does not exist`);let l=await $r(a,"png");return i=Me(i),r+'src="'+l+'"'+ke(i,'"')})(e)),n.push(e)}),n=ke(n,"\n"),n})(p,h);let m=a;return m=Tn(m,"{html}",gt(await vo(h,{...i,funWalkTokens:async e=>{if("image"===e.type&&l)try{let n=t.resolve(o,e.href);Yn(n)?e.href=await $r(n,"png"):console.log(`href[${e.href}] does not exist`)}catch(t){console.log(t)}},mergeStyle:!0}),"html","")),m=Tn(m,"{title}",f),m=Tn(m,'<h2 id="footnote-label" class="sr-only">Footnotes</h2>','<h2 id="footnote-label" class="sr-only" style="height:0px; line-height:0px; min-height:0px; overflow:hidden;">Footnotes</h2>'),m=m.replaceAll("<li>",'<li style="margin:7px 0;">'),m=m.replaceAll("<docx_br>",'\n<div style="height:0; overflow:hidden;">\n    <br>\n</div>    \n        '),m=(t=>{let e=u.load(t);return e('[style*="display:none"]').remove(),e.html()})(m),vn(c)&&wn(r=c({fpOut:r,pretitle:d}))&&(r=await r),e.writeFileSync(r,m,"utf8"),"ok"}});
//# sourceMappingURL=w-md2html.umd.js.map
