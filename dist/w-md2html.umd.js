/*!
 * w-md2html v1.0.12
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs"),require("marked"),require("marked-katex-extension"),require("marked-footnote"),require("highlight.js"),require("marked-highlight"),require("sharp"),require("cheerio")):"function"==typeof define&&define.amd?define(["path","fs","marked","marked-katex-extension","marked-footnote","highlight.js","marked-highlight","sharp","cheerio"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-md2html"]=e(t.path,t.fs,t.marked,t["marked-katex-extension"],t["marked-footnote"],t.highlight.js,t["marked-highlight"],t.sharp,t.cheerio)}(this,function(t,e,r,n,o,i,u,a,f){"use strict";function c(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:!0,get:function(){return t[r]}})}}),e.default=t,Object.freeze(e)}var l=c(f),s=Array.isArray,p="object"==typeof global&&global&&global.Object===Object&&global,h="object"==typeof self&&self&&self.Object===Object&&self,v=p||h||Function("return this")(),d=v.Symbol,g=Object.prototype,y=g.hasOwnProperty,b=g.toString,j=d?d.toStringTag:void 0;var _=Object.prototype.toString;var m=d?d.toStringTag:void 0;function O(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":m&&m in Object(t)?function(t){var e=y.call(t,j),r=t[j];try{t[j]=void 0;var n=!0}catch(t){}var o=b.call(t);return n&&(e?t[j]=r:delete t[j]),o}(t):function(t){return _.call(t)}(t)}function w(t){return null!=t&&"object"==typeof t}function S(t){return"symbol"==typeof t||w(t)&&"[object Symbol]"==O(t)}var x=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/;function z(t,e){if(s(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!S(t))||(A.test(t)||!x.test(t)||null!=e&&t in Object(e))}function $(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function k(t){if(!$(t))return!1;var e=O(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var H,P=v["__core-js_shared__"],E=(H=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+H:"";var F=Function.prototype.toString;function R(t){if(null!=t){try{return F.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var T=/^\[object .+?Constructor\]$/,B=Function.prototype,M=Object.prototype,N=B.toString,q=M.hasOwnProperty,I=RegExp("^"+N.call(q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function C(t){return!(!$(t)||(e=t,E&&E in e))&&(k(t)?I:T).test(R(t));var e}function D(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return C(r)?r:void 0}var L=D(Object,"create");var U=Object.prototype.hasOwnProperty;var V=Object.prototype.hasOwnProperty;function W(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function G(t,e){return t===e||t!=t&&e!=e}function J(t,e){for(var r=t.length;r--;)if(G(t[r][0],e))return r;return-1}W.prototype.clear=function(){this.__data__=L?L(null):{},this.size=0},W.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},W.prototype.get=function(t){var e=this.__data__;if(L){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return U.call(e,t)?e[t]:void 0},W.prototype.has=function(t){var e=this.__data__;return L?void 0!==e[t]:V.call(e,t)},W.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=L&&void 0===e?"__lodash_hash_undefined__":e,this};var K=Array.prototype.splice;function Q(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Q.prototype.clear=function(){this.__data__=[],this.size=0},Q.prototype.delete=function(t){var e=this.__data__,r=J(e,t);return!(r<0)&&(r==e.length-1?e.pop():K.call(e,r,1),--this.size,!0)},Q.prototype.get=function(t){var e=this.__data__,r=J(e,t);return r<0?void 0:e[r][1]},Q.prototype.has=function(t){return J(this.__data__,t)>-1},Q.prototype.set=function(t,e){var r=this.__data__,n=J(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var X=D(v,"Map");function Y(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Z(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.size=0,this.__data__={hash:new W,map:new(X||Q),string:new W}},Z.prototype.delete=function(t){var e=Y(this,t).delete(t);return this.size-=e?1:0,e},Z.prototype.get=function(t){return Y(this,t).get(t)},Z.prototype.has=function(t){return Y(this,t).has(t)},Z.prototype.set=function(t,e){var r=Y(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function tt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(tt.Cache||Z),r}tt.Cache=Z;var et,rt,nt,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/\\(\\)?/g,ut=(et=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ot,function(t,r,n,o){e.push(n?o.replace(it,"$1"):r||t)}),e},rt=tt(et,function(t){return 500===nt.size&&nt.clear(),t}),nt=rt.cache,rt),at=ut;function ft(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var ct=d?d.prototype:void 0,lt=ct?ct.toString:void 0;function st(t){if("string"==typeof t)return t;if(s(t))return ft(t,st)+"";if(S(t))return lt?lt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function pt(t){return null==t?"":st(t)}function ht(t,e){return s(t)?t:z(t,e)?[t]:at(pt(t))}function vt(t){if("string"==typeof t||S(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function dt(t,e){for(var r=0,n=(e=ht(e,t)).length;null!=t&&r<n;)t=t[vt(e[r++])];return r&&r==n?t:void 0}function gt(t,e,r){var n=null==t?void 0:dt(t,e);return void 0===n?r:n}function yt(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var bt,jt=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),u=i.length;u--;){var a=i[bt?u:++n];if(!1===e(o[a],a,o))break}return t};function _t(t){return w(t)&&"[object Arguments]"==O(t)}var mt=Object.prototype,Ot=mt.hasOwnProperty,wt=mt.propertyIsEnumerable,St=_t(function(){return arguments}())?_t:function(t){return w(t)&&Ot.call(t,"callee")&&!wt.call(t,"callee")},xt=St;var At="object"==typeof exports&&exports&&!exports.nodeType&&exports,zt=At&&"object"==typeof module&&module&&!module.nodeType&&module,$t=zt&&zt.exports===At?v.Buffer:void 0,kt=($t?$t.isBuffer:void 0)||function(){return!1},Ht=/^(?:0|[1-9]\d*)$/;function Pt(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Ht.test(t))&&t>-1&&t%1==0&&t<e}function Et(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}var Ft={};function Rt(t){return function(e){return t(e)}}Ft["[object Float32Array]"]=Ft["[object Float64Array]"]=Ft["[object Int8Array]"]=Ft["[object Int16Array]"]=Ft["[object Int32Array]"]=Ft["[object Uint8Array]"]=Ft["[object Uint8ClampedArray]"]=Ft["[object Uint16Array]"]=Ft["[object Uint32Array]"]=!0,Ft["[object Arguments]"]=Ft["[object Array]"]=Ft["[object ArrayBuffer]"]=Ft["[object Boolean]"]=Ft["[object DataView]"]=Ft["[object Date]"]=Ft["[object Error]"]=Ft["[object Function]"]=Ft["[object Map]"]=Ft["[object Number]"]=Ft["[object Object]"]=Ft["[object RegExp]"]=Ft["[object Set]"]=Ft["[object String]"]=Ft["[object WeakMap]"]=!1;var Tt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Bt=Tt&&"object"==typeof module&&module&&!module.nodeType&&module,Mt=Bt&&Bt.exports===Tt&&p.process,Nt=function(){try{var t=Bt&&Bt.require&&Bt.require("util").types;return t||Mt&&Mt.binding&&Mt.binding("util")}catch(t){}}(),qt=Nt&&Nt.isTypedArray,It=qt?Rt(qt):function(t){return w(t)&&Et(t.length)&&!!Ft[O(t)]},Ct=Object.prototype.hasOwnProperty;function Dt(t,e){var r=s(t),n=!r&&xt(t),o=!r&&!n&&kt(t),i=!r&&!n&&!o&&It(t),u=r||n||o||i,a=u?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],f=a.length;for(var c in t)!e&&!Ct.call(t,c)||u&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Pt(c,f))||a.push(c);return a}var Lt=Object.prototype;var Ut=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),Vt=Ut,Wt=Object.prototype.hasOwnProperty;function Gt(t){if(r=(e=t)&&e.constructor,e!==("function"==typeof r&&r.prototype||Lt))return Vt(t);var e,r,n=[];for(var o in Object(t))Wt.call(t,o)&&"constructor"!=o&&n.push(o);return n}function Jt(t){return null!=t&&Et(t.length)&&!k(t)}function Kt(t){return Jt(t)?Dt(t):Gt(t)}var Qt=function(t,e){return function(r,n){if(null==r)return r;if(!Jt(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}(function(t,e){return t&&jt(t,e,Kt)}),Xt=Qt;function Yt(t){return t}function Zt(t,e){var r;return(s(t)?yt:Xt)(t,"function"==typeof(r=e)?r:Yt)}function te(t){var e=this.__data__=new Q(t);this.size=e.size}te.prototype.clear=function(){this.__data__=new Q,this.size=0},te.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},te.prototype.get=function(t){return this.__data__.get(t)},te.prototype.has=function(t){return this.__data__.has(t)},te.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Q){var n=r.__data__;if(!X||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Z(n)}return r.set(t,e),this.size=r.size,this};function ee(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Z;++e<r;)this.add(t[e])}function re(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function ne(t,e){return t.has(e)}ee.prototype.add=ee.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},ee.prototype.has=function(t){return this.__data__.has(t)};function oe(t,e,r,n,o,i){var u=1&r,a=t.length,f=e.length;if(a!=f&&!(u&&f>a))return!1;var c=i.get(t),l=i.get(e);if(c&&l)return c==e&&l==t;var s=-1,p=!0,h=2&r?new ee:void 0;for(i.set(t,e),i.set(e,t);++s<a;){var v=t[s],d=e[s];if(n)var g=u?n(d,v,s,e,t,i):n(v,d,s,t,e,i);if(void 0!==g){if(g)continue;p=!1;break}if(h){if(!re(e,function(t,e){if(!ne(h,e)&&(v===t||o(v,t,r,n,i)))return h.push(e)})){p=!1;break}}else if(v!==d&&!o(v,d,r,n,i)){p=!1;break}}return i.delete(t),i.delete(e),p}var ie=v.Uint8Array;function ue(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function ae(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var fe=d?d.prototype:void 0,ce=fe?fe.valueOf:void 0;var le=Object.prototype.propertyIsEnumerable,se=Object.getOwnPropertySymbols,pe=se?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(se(t),function(e){return le.call(t,e)}))}:function(){return[]},he=pe;function ve(t){return function(t,e,r){var n=e(t);return s(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,Kt,he)}var de=Object.prototype.hasOwnProperty;var ge=D(v,"DataView"),ye=D(v,"Promise"),be=D(v,"Set"),je=D(v,"WeakMap"),_e="[object Map]",me="[object Promise]",Oe="[object Set]",we="[object WeakMap]",Se="[object DataView]",xe=R(ge),Ae=R(X),ze=R(ye),$e=R(be),ke=R(je),He=O;(ge&&He(new ge(new ArrayBuffer(1)))!=Se||X&&He(new X)!=_e||ye&&He(ye.resolve())!=me||be&&He(new be)!=Oe||je&&He(new je)!=we)&&(He=function(t){var e=O(t),r="[object Object]"==e?t.constructor:void 0,n=r?R(r):"";if(n)switch(n){case xe:return Se;case Ae:return _e;case ze:return me;case $e:return Oe;case ke:return we}return e});var Pe=He,Ee="[object Arguments]",Fe="[object Array]",Re="[object Object]",Te=Object.prototype.hasOwnProperty;function Be(t,e,r,n,o,i){var u=s(t),a=s(e),f=u?Fe:Pe(t),c=a?Fe:Pe(e),l=(f=f==Ee?Re:f)==Re,p=(c=c==Ee?Re:c)==Re,h=f==c;if(h&&kt(t)){if(!kt(e))return!1;u=!0,l=!1}if(h&&!l)return i||(i=new te),u||It(t)?oe(t,e,r,n,o,i):function(t,e,r,n,o,i,u){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!i(new ie(t),new ie(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return G(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=ue;case"[object Set]":var f=1&n;if(a||(a=ae),t.size!=e.size&&!f)return!1;var c=u.get(t);if(c)return c==e;n|=2,u.set(t,e);var l=oe(a(t),a(e),n,o,i,u);return u.delete(t),l;case"[object Symbol]":if(ce)return ce.call(t)==ce.call(e)}return!1}(t,e,f,r,n,o,i);if(!(1&r)){var v=l&&Te.call(t,"__wrapped__"),d=p&&Te.call(e,"__wrapped__");if(v||d){var g=v?t.value():t,y=d?e.value():e;return i||(i=new te),o(g,y,r,n,i)}}return!!h&&(i||(i=new te),function(t,e,r,n,o,i){var u=1&r,a=ve(t),f=a.length;if(f!=ve(e).length&&!u)return!1;for(var c=f;c--;){var l=a[c];if(!(u?l in e:de.call(e,l)))return!1}var s=i.get(t),p=i.get(e);if(s&&p)return s==e&&p==t;var h=!0;i.set(t,e),i.set(e,t);for(var v=u;++c<f;){var d=t[l=a[c]],g=e[l];if(n)var y=u?n(g,d,l,e,t,i):n(d,g,l,t,e,i);if(!(void 0===y?d===g||o(d,g,r,n,i):y)){h=!1;break}v||(v="constructor"==l)}if(h&&!v){var b=t.constructor,j=e.constructor;b==j||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof j&&j instanceof j||(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,o,i))}function Me(t,e,r,n,o){return t===e||(null==t||null==e||!w(t)&&!w(e)?t!=t&&e!=e:Be(t,e,r,n,Me,o))}function Ne(t){return t==t&&!$(t)}function qe(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function Ie(t){var e=function(t){for(var e=Kt(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Ne(o)]}return e}(t);return 1==e.length&&e[0][2]?qe(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var a=r[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var f=(a=r[o])[0],c=t[f],l=a[1];if(u&&a[2]){if(void 0===c&&!(f in t))return!1}else{var s=new te;if(n)var p=n(c,l,f,t,e,s);if(!(void 0===p?Me(l,c,3,n,s):p))return!1}}return!0}(r,t,e)}}function Ce(t,e){return null!=t&&e in Object(t)}function De(t,e){return null!=t&&function(t,e,r){for(var n=-1,o=(e=ht(e,t)).length,i=!1;++n<o;){var u=vt(e[n]);if(!(i=null!=t&&r(t,u)))break;t=t[u]}return i||++n!=o?i:!!(o=null==t?0:t.length)&&Et(o)&&Pt(u,o)&&(s(t)||xt(t))}(t,e,Ce)}function Le(t){return function(e){return null==e?void 0:e[t]}}function Ue(t){return z(t)?Le(vt(t)):function(t){return function(e){return dt(e,t)}}(t)}function Ve(t){return"function"==typeof t?t:null==t?Yt:"object"==typeof t?s(t)?function(t,e){return z(t)&&Ne(e)?qe(vt(t),e):function(r){var n=gt(r,t);return void 0===n&&n===e?De(r,t):Me(e,n,3)}}(t[0],t[1]):Ie(t):Ue(t)}function We(t,e){var r=-1,n=Jt(t)?Array(t.length):[];return Xt(t,function(t,o,i){n[++r]=e(t,o,i)}),n}function Ge(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+e];return i}function Je(t,e,r){var n=t.length;return r=void 0===r?n:r,!e&&r>=n?t:Ge(t,e,r)}var Ke=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function Qe(t){return Ke.test(t)}var Xe=Nt&&Nt.isRegExp,Ye=Xe?Rt(Xe):function(t){return w(t)&&"[object RegExp]"==O(t)};var Ze="\\ud800-\\udfff",tr="["+Ze+"]",er="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",rr="\\ud83c[\\udffb-\\udfff]",nr="[^"+Ze+"]",or="(?:\\ud83c[\\udde6-\\uddff]){2}",ir="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="(?:"+er+"|"+rr+")"+"?",ar="[\\ufe0e\\ufe0f]?",fr=ar+ur+("(?:\\u200d(?:"+[nr,or,ir].join("|")+")"+ar+ur+")*"),cr="(?:"+[nr+er+"?",er,or,ir,tr].join("|")+")",lr=RegExp(rr+"(?="+rr+")|"+cr+fr,"g");function sr(t){return Qe(t)?function(t){return t.match(lr)||[]}(t):function(t){return t.split("")}(t)}function pr(t,e,r){return r&&"number"!=typeof r&&function(t,e,r){if(!$(r))return!1;var n=typeof e;return!!("number"==n?Jt(r)&&Pt(e,r.length):"string"==n&&e in r)&&G(r[e],t)}(t,e,r)&&(e=r=void 0),(r=void 0===r?4294967295:r>>>0)?(t=pt(t))&&("string"==typeof e||null!=e&&!Ye(e))&&!(e=st(e))&&Qe(t)?Je(sr(t),0,r):t.split(e,r):[]}var hr=/\s/;var vr=/^\s+/;function dr(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&hr.test(t.charAt(e)););return e}(t)+1).replace(vr,""):t}function gr(t){return t!=t}function yr(t,e,r){return e==e?function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,r):function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,gr,r)}function br(t,e,r){if((t=pt(t))&&(r||void 0===e))return dr(t);if(!t||!(e=st(e)))return t;var n=sr(t),o=sr(e),i=function(t,e){for(var r=-1,n=t.length;++r<n&&yr(e,t[r],0)>-1;);return r}(n,o),u=function(t,e){for(var r=t.length;r--&&yr(e,t[r],0)>-1;);return r}(n,o)+1;return Je(n,i,u).join("")}var jr=Array.prototype.join;function _r(t,e){return null==t?"":jr.call(t,e)}var mr=/^[-+]0x[0-9a-f]+$/i,Or=/^0b[01]+$/i,wr=/^0o[0-7]+$/i,Sr=parseInt;function xr(t){if("number"==typeof t)return t;if(S(t))return NaN;if($(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=$(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=dr(t);var r=Or.test(t);return r||wr.test(t)?Sr(t.slice(2),r?2:8):mr.test(t)?NaN:+t}var Ar=1/0;function zr(t){return t?(t=xr(t))===Ar||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function $r(t){var e=zr(t),r=e%1;return e==e?r?e-r:e:0}function kr(t,e,r){var n=null==t?0:t.length;return n?Ge(t,(e=r||void 0===e?1:$r(e))<0?0:e,n):[]}var Hr=Le("length"),Pr="\\ud800-\\udfff",Er="["+Pr+"]",Fr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Rr="\\ud83c[\\udffb-\\udfff]",Tr="[^"+Pr+"]",Br="(?:\\ud83c[\\udde6-\\uddff]){2}",Mr="[\\ud800-\\udbff][\\udc00-\\udfff]",Nr="(?:"+Fr+"|"+Rr+")"+"?",qr="[\\ufe0e\\ufe0f]?",Ir=qr+Nr+("(?:\\u200d(?:"+[Tr,Br,Mr].join("|")+")"+qr+Nr+")*"),Cr="(?:"+[Tr+Fr+"?",Fr,Br,Mr,Er].join("|")+")",Dr=RegExp(Rr+"(?="+Rr+")|"+Cr+Ir,"g");function Lr(t){return Qe(t)?function(t){for(var e=Dr.lastIndex=0;Dr.test(t);)++e;return e}(t):Hr(t)}function Ur(t){if(null==t)return 0;if(Jt(t))return"string"==typeof(e=t)||!s(e)&&w(e)&&"[object String]"==O(e)?Lr(t):t.length;var e,r=Pe(t);return"[object Map]"==r||"[object Set]"==r?t.size:Gt(t).length}function Vr(t){return!0===(e=t)||!1===e||w(e)&&"[object Boolean]"==O(e);var e}function Wr(t){return"[object String]"===Object.prototype.toString.call(t)}function Gr(t){return!(!Wr(t)||""===t)}function Jr(t){return"[object Array]"===Object.prototype.toString.call(t)}function Kr(t){return"[object Object]"===Object.prototype.toString.call(t)}function Qr(t){return t!=t}function Xr(t){return!!function(t){return"[object Undefined]"===Object.prototype.toString.call(t)}(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Kr(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!Wr(t)||""!==t)}(t)||(!!function(t){return!!Jr(t)&&0===t.length}(t)||!!Qr(t)))))}function Yr(t){let e=!1;if(Gr(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Qr(t))return!1;e=!0}return e}function Zr(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function tn(t){if(!Yr(t))return 0;return zr(t)}function en(t,e,r){if(!Gr(t))return"";if(!Gr(e))return"";if(!Wr(r))return"";return String(t).replaceAll(e,r)}function rn(t,e){let r=function(){let t,e,r=new Promise(function(){t=arguments[0],e=arguments[1]});return r.resolve=t,r.reject=e,r}();if(!Jr(t)&&!Kr(t))return r.reject("rs is not an array or object"),r;let n=!1;if(Kr(t)){n=!0;let e=[];Zt(t,(t,r)=>{e.push({k:r,v:t})}),t=e}Zr(e)||(e=function(t){return t});let o=-1,i=[];return t.reduce(function(t,r){return t.then(function(t){i.push(t),o+=1;let u=o,a=r;return n&&(u=r.k,a=r.v),Zr(e)?e(a,u):a})},Promise.resolve()).then(function(t){i.push(t),i=kr(i),r.resolve(i)}).catch(function(t){r.reject(t)}),r}function nn(t){return!!Yr(t)&&(t=tn(t),"number"==typeof(e=t)&&e==$r(e));var e}var on=v.isFinite,un=Math.min;var an=function(t){var e=Math[t];return function(t,r){if(t=xr(t),(r=null==r?0:un($r(r),292))&&on(t)){var n=(pt(t)+"e").split("e");return+((n=(pt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),fn=an;function cn(t){if(!Yr(t))return 0;t=tn(t);let e=fn(t);return"0"===String(e)?0:e}function ln(t){if(!nn(t))return!1;return cn(t)>=0}function sn(t,e){if(!Gr(t))return"";if(!ln(e))return"";if(0===(e=cn(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}function pn(t,e){return Gr(t)&&ln(e)?0===(e=cn(e))?t:function(t,e){return Gr(t)&&ln(e)?0===(e=cn(e))?"":t.substring(0,e):""}(t,t.length-e):""}function hn(t){if(!Gr(t))return{path:"",isRoot:!1};for(;t.indexOf("\\\\")>=0;)t=t.replace("\\\\","\\");for(;t.indexOf("//")>=0;)t=t.replace("//","/");if(":"===sn(t,1))return{path:`${t}\\`,isRoot:!0};if("\\"===sn(t,1)){let e=pn(t,1);return":"===sn(e,1)?{path:t,isRoot:!0}:{path:e,isRoot:!1}}if("/"===sn(t,1)){let e=pn(t,1);return 0===e.length?{path:t,isRoot:!0}:{path:e,isRoot:!1}}return{path:t,isRoot:!1}}function vn(t){if(!Gr(t))return"";let e=hn(t);if(e.isRoot)return e.path;let r=e.path;try{r=r.split("\\").pop().split("/").pop()}catch(t){}return r}function dn(t){if(!Gr(t))return"";let e=vn(t),r=pr(e,".");if(Ur(r)<=1)return e;let n="";try{r=(a=null==(o=r)?0:o.length)?Ge(o,0,(i=a-(i=u||void 0===i?1:$r(i)))<0?0:i):[],n=_r(r,".")}catch(t){}var o,i,u,a;return n}function gn(t){if(!Gr(t))return"";let e=hn(t);if(e.isRoot)return e.path;let r=vn(t=e.path);if(!Gr(r))return t;let n=hn(t=pn(t,r.length));return n.isRoot,n.path}function yn(t){return function(t,e={}){let r=gt(e,"fs");return!!r.existsSync(t)&&!r.lstatSync(t).isDirectory()&&!r.lstatSync(t).isSymbolicLink()}(t,{fs:e})}function bn(t){if(!Gr(t))return"";let e=pr(vn(t),".");if(Ur(e)<=1)return"";let r="";try{r=(o=null==(n=e)?0:n.length)?n[o-1]:void 0}catch(t){}var n,o;return r}let jn=t=>"png"===(t=pt(t).toLowerCase())?"image/png":"jpg"===t||"jpeg"===t?"image/jpeg":"gif"===t?"image/gif":"svg"===t?"image/svg+xml":"webp"===t?"image/webp":"application/octet-stream",_n=async t=>{let r=bn(t),n=(t=>{let r=e.readFileSync(t);return Buffer.from(r).toString("base64")})(t);return`data:${jn(r)};base64,${n}`},mn=async t=>{let r=await(async(t,r={})=>{let n=gt(r,"density");Yr(n)||(n=96),n=tn(n);let o=gt(r,"returnBase64");Vr(o)||(o=!1);let i=e.readFileSync(t),u=await a(i,{density:n}).png().toBuffer(),f=u;o&&(f="data:image/png;base64,"+u.toString("base64"));return f})(t,{returnBase64:!0});return r},On=async t=>{let e="";return e="svg"===bn(t)?await mn(t):await _n(t),e};return async function(a,f,c={}){if(!yn(a))return Promise.reject(`fpIn[${a}] does not exist`);let p=gn(a=t.resolve(a)),h=gt(c,"fpInTemp");if(!yn(h)){let t="./src/html.tmp",e="./node_modules/w-md2html/src/html.tmp";if(yn(t))h=t;else{if(!yn(e))throw new Error(`fpInTemp[${h}] does not exist`);h=e}}h=t.resolve(h);let v=gt(c,"imgWidthMax",null);Yr(v)&&(v=`${v}px`);let d=gt(c,"imgConvertToBase64",null);Vr(d)||(d=!0);let g=gt(c,"funProcFpOut"),y=(t,e)=>{let r=pr(t,"\n"),n=0,o=[],i={};Zt(r,t=>{let r=t;if(t.indexOf(`${e}n`)>=0){let o;n++,r=en(t,`${e}n`,`${e}${n}`),o=t,o=en(o,'<div style="margin:1rem 0;">',""),o=en(o,"</div>",""),o=en(o,`${e}n`,""),o=br(o),o=`{${o}}`,i[o]=`${e}${n}`}o.push(r)});let u=_r(o,"\n");return Zt(i,(t,e)=>{u=u.replaceAll(e,t)}),u},b=gt(c,"fontFamilies",[]);var j,_,m;(!Jr(j=b)||0===j.length||1===j.length&&Xr(j[0]))&&(b=["Microsoft JhengHei","Avenir","Helvetica","Arial","sans-serif"]),b=_r((m=t=>`'${t}'`,(s(_=b)?ft:We)(_,Ve(m))),", ");let O=gt(c,"fontSizeUnit","");Gr(O)||(O="pt");let w=gt(c,"fontSizeScale","");Yr(w)||(w=1),w=tn(w);let S=gt(c,"fontSizeDef","");Gr(S)||(S=12*w+O);let x=gt(c,"fontSizeH1","");Gr(x)||(x=20*w+O);let A=gt(c,"fontSizeH2","");Gr(A)||(A=16*w+O);let z=gt(c,"fontSizeH3","");Gr(z)||(z=14*w+O);let $=gt(c,"fontSizeH4","");Gr($)||($=12*w+O);let k=gt(c,"fontSizeH5","");Gr(k)||(k=12*w+O);let H=gt(c,"fontSizeH6","");Gr(H)||(H=12*w+O);let P=gt(c,"fontSizeP","");Gr(P)||(P=12*w+O);let E=gt(c,"fontSizeTab","");Gr(E)||(E=11*w+O);let F=gt(c,"fontSizeCode","");Gr(F)||(F=10*w+O);let R=gt(c,"textAlignH1","");Gr(R)||(R="left");let T=gt(c,"textAlignH2","");Gr(T)||(T="left");let B=gt(c,"textAlignH3","");Gr(B)||(B="left");let M=gt(c,"textAlignH4","");Gr(M)||(M="left");let N=gt(c,"textAlignH5","");Gr(N)||(N="left");let q=gt(c,"textAlignH6","");Gr(q)||(q="left");let I=e.readFileSync(h,"utf8"),C=dn(a),D=gn(a),L=e.readFileSync(a,"utf8"),U=(t=>{let e=pr(t,"\n"),r="";return Zt(e,(t,n)=>{if(t.indexOf(" pretitle ")>=0)return r=gt(e,n+1,""),r=br(r),!1}),r})(L);L=y(L,"圖"),L=y(L,"表"),L=await(async(t,e)=>{let r=[],n=pr(e,"\n");return await rn(n,async e=>{e.indexOf('src="')>=0&&(e=await(async e=>{let r=pr(e,'src="');if(2!==Ur(r))throw new Error("size(s)!==2");let n=r[0],o=pr(r[1],'"'),i=o[0],u="";if(yn(i))u=i;else if(u=`${t}/${i}`,!yn(u))throw console.log("c",e),console.log("fnp",i),new Error(`fp[${u}] does not exist`);let a=await On(u);return o=kr(o),n+'src="'+a+'"'+_r(o,'"')})(e)),r.push(e)}),r=_r(r,"\n"),r})(D,L);let V=new r.Marked;V.use(n({throwOnError:!1,nonStandard:!0})),V.use(o()),V.use(u.markedHighlight({langPrefix:"hljs language-",emptyLangClass:"hljs",highlight(t,e){let r=e&&i.getLanguage(e)?e:"plaintext";return i.highlight(t,{language:r}).value}}));let W={image:({href:t,title:e,text:r})=>{let n=Gr(e)?`title="${e}"`:"",o="";return Gr(v)&&(o=`max-width:${v}; height:auto;`),`<img src="${t}" alt="${r}" ${n} style="${o}">`}};V.use({async:!0,renderer:W,walkTokens:async e=>{if("image"===e.type&&d)try{let r=t.resolve(p,e.href);yn(r)?e.href=await On(r):console.log(`href[${e.href}] does not exist`)}catch(t){console.log(t)}}});let G=I;return G=en(G,"{html}",await V.parse(L)),G=en(G,"{title}",C),G=en(G,"{fontFamilies}",b),G=en(G,"{fontSizeDef}",S),G=en(G,"{fontSizeH1}",x),G=en(G,"{fontSizeH2}",A),G=en(G,"{fontSizeH3}",z),G=en(G,"{fontSizeH4}",$),G=en(G,"{fontSizeH5}",k),G=en(G,"{fontSizeH6}",H),G=en(G,"{fontSizeP}",P),G=en(G,"{fontSizeTab}",E),G=en(G,"{fontSizeCode}",F),G=en(G,"{textAlignH1}",R),G=en(G,"{textAlignH2}",T),G=en(G,"{textAlignH3}",B),G=en(G,"{textAlignH4}",M),G=en(G,"{textAlignH5}",N),G=en(G,"{textAlignH6}",q),G=en(G,'<h2 id="footnote-label" class="sr-only">Footnotes</h2>','<h2 id="footnote-label" class="sr-only" style="height:0px; line-height:0px; min-height:0px; overflow:hidden;">Footnotes</h2>'),G=G.replaceAll("<li>",'<li style="margin:7px 0;">'),G=(t=>{const e=l.load(t);return e('[style*="display:none"]').remove(),e.html()})(G),Zr(g)&&(f=g({fpOut:f,pretitle:U})),e.writeFileSync(f,G,"utf8"),"ok"}});
//# sourceMappingURL=w-md2html.umd.js.map
